{"version":3,"sources":["../../../../../../../assets/scripts/framework/net/socket/assets/scripts/framework/net/socket/NetProxy.js"],"names":["GameNetwork","require","GameProtocols","GAME_SERVER_URL","NetProxy","cc","Class","ctor","network","_cachePushCallback","init","setDelegate","initPushCallback","connect","closeConnect","isNetworkOpened","isSocketOpened","isNetworkClosed","isSocketClosed","onNetworkOpen","Global","eventMgr","emit","config","EVENT_NETWORK_OPENED","onNetworkClose","EVENT_NETWORK_CLOSED","self","pushCallback","resp","registerPushResponseCallback","registerPush","key","cb","target","bind","act","dealCachePush","beatHeart","callback","req","HeartRequest","t","Date","now","sendRequest","chat","msg","ChatRequest","uid","randomMatch","RandomMatchRequest","playChess","PlayChessRequest","lastBedIndex","cid","dest","selectChess","SelectChessRequest","createRoom","CreateRoomRequest","joinRoom","rid","JoinRoomRequest","login","origin","token","LoginRequest","os","sys","osVersion","err","EVENT_LOGIN_FAILED","EVENT_LOGIN_SUC","logout","bindFacebook","getRank","rankType","response","pushFriendSendTakeSp","pushPlayChess","pushChat","pushExitRoom","EVENT_CHAT","EVENT_EXITROOM","EVENT_PLAYCHESS","debug_addCoins","name","DebugChangeMeRequest","cmd","module","exports"],"mappings":"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","file":"NetProxy.js","sourceRoot":"../../../../../../../assets/scripts/framework/net/socket","sourcesContent":["/**\n * Created by skyxu on 2018/10/9.\n */\n\n\"use strict\";\n\nlet GameNetwork = require(\"./GameNetwork\");\nlet GameProtocols = require(\"./GameProtocols\");\n// let DataMgr = require(\"./../../Common/DataMgr\");\n\nlet GAME_SERVER_URL = 'ws://127.0.0.1:3005';\n// GAME_SERVER_URL = 'wss://echo.websocket.org';\n// GAME_SERVER_URL = \"ws://45.123.197.93:3005\";\n\nlet NetProxy = cc.Class({\n    ctor: function () {\n        this.network = null;\n        this._cachePushCallback = [];\n    },\n\n    init: function () {\n        this.network = new GameNetwork();\n        this.network.setDelegate(this);\n        this.initPushCallback();\n    },\n\n    connect: function () {\n        this.network.connect(GAME_SERVER_URL);\n    },\n\n    closeConnect: function () {\n        this.network.closeConnect();\n    },\n\n    isNetworkOpened: function () {\n        return this.network.isSocketOpened();\n    },\n\n    isNetworkClosed: function () {\n        return this.network.isSocketClosed();\n    },\n\n    onNetworkOpen: function () {\n        Global.eventMgr.emit(Global.config.EVENT_NETWORK_OPENED);\n    },\n\n    onNetworkClose: function () {\n        Global.eventMgr.emit(Global.config.EVENT_NETWORK_CLOSED);\n    },\n\n    /**\n     * 注册push回调接口\n     */\n    initPushCallback: function () {\n        let self = this;\n        let pushCallback = function (resp) {\n            self.pushCallback(resp);\n        };\n\n        this.network.registerPushResponseCallback('chat', pushCallback);\n        this.network.registerPushResponseCallback('exitRoom', pushCallback);\n        this.network.registerPushResponseCallback('playChess', pushCallback);\n\n        // let pushCallback = function(response){\n        //     if(Util.DNN(farm.game) && farm.game.loginSuccess){\n        //         this.dealCachePush();\n        //         this.pushCallback(response);\n        //     }else{\n        //         this._cachePushCallback.push(response);\n        //     }\n        // }.bind(this);\n\n        // this.network.registerPushResponseCallback('attacked', pushCallback);\n        // this.network.registerPushResponseCallback('acceptWantHelp', pushCallback);\n        // this.network.registerPushResponseCallback('sendSpNotify', pushCallback);\n        // this.network.registerPushResponseCallback('takeSpNotify', pushCallback);\n        // this.network.registerPushResponseCallback('wanted', pushCallback);\n        // this.network.registerPushResponseCallback('incomplete', pushCallback);\n        // this.network.registerPushResponseCallback('newFriend', pushCallback);\n        // this.network.registerPushResponseCallback('news', pushCallback);\n        // this.network.registerPushResponseCallback('hatredInfoSync', pushCallback);\n        // this.network.registerPushResponseCallback('friendInfoSync', pushCallback);\n    },\n\n    /**\n     * 注册推送\n     * @param {String} key\n     * @param {function(resp)} cb\n     */\n    registerPush(key, cb, target){\n        let self = this;\n        if (cb && target){\n            cb = cb.bind(target);\n        }\n        let pushCallback = function (resp) {\n            if (cb){\n                cb(resp);\n            }\n            Global.eventMgr.emit(resp.act, resp);\n        };\n\n        this.network.registerPushResponseCallback(key, pushCallback);\n    },\n\n    /**\n     * 处理缓存push\n     */\n    dealCachePush: function () {\n        // if(this._cachePushCallback.length > 0){\n        //     for(var i = 0; i < this._cachePushCallback.length; i++){\n        //         this.pushCallback(this._cachePushCallback[i]);\n        //     }\n        // }\n        // this._cachePushCallback = [];\n    },\n\n    beatHeart: function (callback) {\n        let req = new GameProtocols.HeartRequest();\n        req.t = Date.now();\n        this.network.sendRequest(req, callback);\n    },\n\n    chat: function (msg) {\n        let req = new GameProtocols.ChatRequest();\n        // let uid = DataMgr.getInstance().playerObj.uid;\n        let uid = \"\";\n        req.uid = uid;\n        req.msg = msg;\n        this.network.sendRequest(req);\n    },\n\n    // 开始随机匹配\n    randomMatch: function () {\n        let req = new GameProtocols.RandomMatchRequest();\n        // let uid = DataMgr.getInstance().playerObj.uid;\n        let uid = \"\";\n        req.uid = uid;\n        this.network.sendRequest(req);\n    },\n\n    playChess: function (msg) {\n        let req = new GameProtocols.PlayChessRequest();\n        // let uid = DataMgr.getInstance().playerObj.uid;\n        let uid = \"\";\n        req.uid = uid;\n        req.lastBedIndex = msg.lastBedIndex;\n        req.cid = msg.cid;\n        req.dest = msg.dest;\n        this.network.sendRequest(req);\n    },\n\n    selectChess: function (msg) {\n        let req = new GameProtocols.SelectChessRequest();\n        req.cid = msg.cid;\n        this.network.sendRequest(req);\n    },\n\n    createRoom: function (cb) {\n        let req = new GameProtocols.CreateRoomRequest();\n        this.network.sendRequest(req, cb);\n    },\n\n    joinRoom: function (rid) {\n        let req = new GameProtocols.JoinRoomRequest();\n        req.rid = rid;\n        this.network.sendRequest(req);\n    },\n\n    /**\n     * Facebook或者游客登录接口\n     * @param {Object.<LoginOriginType>} origin\n     * @param token\n     */\n    login: function (origin, token) {\n        let req = new GameProtocols.LoginRequest();\n        if(token) req.token = token;\n        req.origin = origin;\n        req.os = cc.sys.os;\n        req.osVersion = cc.sys.osVersion;\n\n        // let uid = DataMgr.getInstance().playerObj.uid;\n        let uid = \"\";\n        req.uid = uid;\n        // req.language = cc.sys.language;//farm.FarmPlatformHelper.jsToOc(farm.FarmPlatformHelper.JSB_EVENT_JTO_GetCurrentLanguage);\n        /*\n         req.deviceModel = '';\n         req.channelId = 0;\n         req.idfa = '';\n         req.androidId = '';\n         req.googleAid = '';\n         req.appVersion = '';\n         req.packName = '';\n         */\n        let callback =  function (resp) {\n            if(resp.err != 0){\n                Global.eventMgr.emit(Global.config.EVENT_LOGIN_FAILED, resp);\n                return;\n            }\n            // if(resp.token && resp.token.length > 0){\n            //     farm.localStorage.setItem(farm.game.gmConst.GLS_KEY_GUEST_TOKEN, resp.token);\n            // }\n            // farm.localStorage.removeItem(farm.game.gmConst.GLS_KEY_IS_LOGOUT);\n            //\n            // //\n            // farm.game.initConfig(resp);\n            // farm.game.initData(resp);\n            // farm.game.loginSuccess = true;\n\n            // js 调取其他平台的sdk，传过去玩家id\n            // farm.FarmPlatformHelper.jsToOc(farm.FarmPlatformHelper.JSB_EVENT_JTO_setSessionWithUid, farm.game.player.id.toString());\n            //\n\n            //登录\n            Global.eventMgr.emit(Global.config.EVENT_LOGIN_SUC, resp);\n        };\n        this.network.sendRequest(req, callback);\n\n    },\n\n    /**\n     * Facebook或者游客登出\n     */\n    logout: function () {\n        // let req = new GameProtocols.LogoutRequest();\n        // this.network.sendRequest(req, function (resp) {\n        //     if(resp.err != 0){\n        //         cc.log(\"网络请求---LogoutRequest 失败\");\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_LOGOUT_FAILED);\n        //         return;\n        //     }\n        //     cc.log(\"网络请求---LogoutRequest 成功\");\n        //     Global.eventMgr.emit(farm.game.gmConst.SP_EVENT_LOGOUT_SUCCESS);\n        // });\n    },\n\n    /**\n     * 绑定fb账号\n     * @param {String} token\n     */\n    bindFacebook: function (token) {\n        // let req = new GameProtocols.BindFacebookRequest();\n        // req.token = token;\n        // let callback =  function (resp) {\n        //     //绑定过得逻辑\n        //     if(resp.err == farm.game.gmConst.ERROR_USER_HAS_REGISTERED){\n        //         cc.log(\"网络请求---BindFacebookRequest 已绑定\");\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_HAS_BIND_FACEBOOK);\n        //         return;\n        //     }\n        //     //绑定失败\n        //     if(resp.err != 0){\n        //         cc.log(\"网络请求---BindFacebookRequest 失败\");\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_BIND_FACEBOOK_FAILED);\n        //         return;\n        //     }\n        //     //绑定成功\n        //     cc.log(\"网络请求---BindFacebookRequest 成功\");\n        //     if(resp.me){\n        //         farm.game.player.parse(resp.me);\n        //     }\n        //     if(resp.friends){\n        //         farm.game.initFriends(resp.friends);\n        //     }\n        //     //绑定成功后删除本地token\n        //     farm.localStorage.removeItem(farm.game.gmConst.GLS_KEY_GUEST_TOKEN);\n        //     farm.eventManager.emit(farm.game.gmConst.SP_EVENT_BIND_FACEBOOK_SUCCESS);\n        // };\n        // this.network.sendRequest(req, callback);\n    },\n\n    /**\n     * 获取排名\n     * @param {Number} rankType 0全部，1本地，2好友\n     */\n    getRank: function (rankType) {\n        // let req = new GameProtocols.RankRequest();\n        // req.type = rankType;\n        // let callback =  function (resp) {\n        //     if(resp.err != 0){\n        //         cc.log(\"网络请求---getRank 失败\");\n        //         Global.eventMgr.emit(farm.game.gmConst.SP_EVENT_GET_RANK_FAILED, resp);\n        //         return;\n        //     }\n        //     cc.log(\"网络请求---getRank 成功\");\n        //     // todo 暂定排名类型\n        //     resp._rankType = rankType;\n        //     //farm.game.initLeaderBoardArray(rankType, resp.myRank, resp.men);\n        //     if(rankType == 2 && resp.men){\n        //         farm.game.updateFriends(resp.men);\n        //         resp.men = farm.game.sortFriendsByStar();\n        //     }\n        //     Global.eventMgr.emit(farm.game.gmConst.SP_EVENT_GET_RANK_SUCCESS, resp);\n        // };\n        // this.network.sendRequest(req, callback);\n    },\n\n\n    //push回调------------------------------------------------------------------------------\n\n    /**\n     * 推送回调\n     */\n    pushCallback: function (response) {\n        switch (response.act){\n            case \"friendInfoSync\":\n                this.pushFriendSendTakeSp(response);\n                break;\n            case \"playChess\":\n                this.pushPlayChess(response);\n                break;\n            case \"chat\":\n                this.pushChat(response);\n                break;\n            case \"exitRoom\":\n                this.pushExitRoom(response);\n                break;\n            default:\n                break;\n        }\n    },\n    /**\n     * 好友间互赠体力推送\n     * @param {PushSendSpResponse|PushTakeSpResponse} resp\n     */\n    pushFriendSendTakeSp: function (resp) {\n        // cc.log(\"网络请求---push--- pushFriendSendTakeSp 成功\");\n        // if(resp.friend) farm.game.updateFriends(resp.friend);\n        // farm.eventManager.emit(farm.game.gmConst.SP_PUSH_EVENT_UPDATE_FRIEND);\n    },\n\n\n    pushChat: function (resp) {\n        Global.eventMgr.emit(Global.config.EVENT_CHAT, resp);\n    },\n\n    pushExitRoom: function (resp) {\n        Global.eventMgr.emit(Global.config.EVENT_EXITROOM, resp);\n    },\n\n    pushPlayChess: function(resp){\n        Global.eventMgr.emit(Global.config.EVENT_PLAYCHESS, resp);\n    },\n\n    /**\n     * debug调试请求\n     * @param {String} name\n     */\n    debug_addCoins: function (name) {\n        var req = new GameProtocols.DebugChangeMeRequest();\n        if (name === \"btnAddCoins\") {\n            req.cmd = \"player coins add 100000000\";\n        } else if (name === \"btnClearCoins\") {\n            req.cmd = \"player coins 0\";\n        } else if (name === \"btnAddEnergy\") {\n            req.cmd = \"player sp add 10\";\n        } else if (name === \"btnClearEnergy\") {\n            req.cmd = \"player sp 0\";\n        } else if (name == \"btnAddWp\") {\n            req.cmd = \"player wp add 10\";\n        } else if (name == \"btnClearWp\") {\n            req.cmd = \"player wp 0\";\n        } else if (name == \"btnUnwrap\"){\n            req.cmd = \"player fbuid null\";\n        } else if (name == \"btnWizard1\"){\n            req.cmd = \"player wizard1 0\";\n        } else if (name == \"btnWizard2\"){\n            req.cmd = \"player wizard2 0\";\n        } else if (name == \"btnClearShield\"){\n            req.cmd = \"player shield 0\";\n        } else if (name == \"btnSpEc\"){\n            req.cmd = \"SpEc stepInterval 60000\";\n        } else if (name == \"btnFarmEc\"){\n            req.cmd = \"FarmEc stepInterval 60000\";\n        } else if (name == \"btnSpEcBack\"){\n            req.cmd = \"SpEc stepInterval 3600000\";\n        } else if (name == \"btnFarmBack\"){\n            req.cmd = \"FarmEc stepInterval 86400000\";\n        } else if (name == \"btnUpdateBuild\"){\n            req.cmd = \"Building lv 5\";\n        } else {\n            req.cmd = name;\n        }\n        // var callback = function (resp) {\n        //     if (resp.err != 0) {\n        //         return;\n        //     }\n        //     farm.game.player.parse(resp.me);\n        //     farm.game.spTimer.updateSpTime(resp.spStepLeftTime, resp.spInterval);\n        //     farm.game.dataUpdater.updateCoin();\n        //     farm.game.dataUpdater.updateSp();\n        //     farm.game.dataUpdater.updateShield();\n        //     farm.game.dataUpdater.updateStar();\n        //     //\n        //     if((req.cmd == \"FarmEc stepInterval 60000\" || req.cmd == \"FarmEc stepInterval 86400000\")\n        //         && farm.util.isNumber(resp.farmDailyOut)\n        //         && farm.util.isNumber(resp.farmCoins)){\n        //         farm.game.piggyBankTimer.init(resp.farmDailyOut, resp.farmCoins, resp.farmInterval);\n        //     }\n        //     if(req.cmd == \"SpEc stepInterval 60000\" || req.cmd == \"SpEc stepInterval 3600000\"){\n        //         farm.game.spTimer.updateSpTime(resp.spStepLeftTime, resp.spInterval);\n        //     }\n        //     if(resp.buildings){\n        //         for(var i = 0; i < resp.buildings.length; ++i){\n        //             farm.game.buildings[i].parse(resp.buildings[i]);\n        //         }\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_UPGRADE_BUILDING_SUCCESS, resp);\n        //         farm.eventManager.emit(farm.game.gmConst.SP_DEBUG_EVENT_BUILD_TO_24_SUCCESS, resp);\n        //     }\n        // };\n        // this.network.sendRequest(req, callback);\n    },\n});\n\nmodule.exports = NetProxy;"]}