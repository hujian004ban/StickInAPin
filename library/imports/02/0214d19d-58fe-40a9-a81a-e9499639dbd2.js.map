{"version":3,"sources":["../../../../../../assets/scripts/framework/ui/assets/scripts/framework/ui/PopBase.js"],"names":["PopBase","cc","Class","extends","Component","properties","maskOpacity","touchClose","initBase","params","popName","CC_EDITOR","componentName","component","popNameSpArr","split","length","node","getComponent","onLaunchedCallback","onClosedCallback","zy","Button","createNode","name","zIndex","constData","ZIndex","POP_MASK","parent","url","touchAction","commonClickAudio","opacity","width","DesignSize","height","eventHandler","target","customEventData","handler","init","cleanBase","clean","isValid","destroy","module","exports"],"mappings":";;;;;;AAAA;;;;AAIA,IAAMA,UAAUC,GAAGC,KAAH,CAAS;AACrBC,aAASF,GAAGG,SADS;;AAGrBC,gBAAY;AACRC,qBAAa,GADL,EACU;AAClBC,oBAAY,IAFJ,CAEU;AAFV,KAHS;;AAQrBC,cAAU,kBAAUC,MAAV,EAAkBC,OAAlB,EAA2B;AACjC,YAAIC,SAAJ,EAAe;;AAEf;AACA,aAAKD,OAAL,GAAeA,OAAf;;AAEA;AACA,aAAKE,aAAL,GAAqB,IAArB;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACA,YAAMC,eAAe,KAAKJ,OAAL,CAAaK,KAAb,CAAmB,GAAnB,CAArB;AACA,YAAID,aAAaE,MAAb,GAAsB,CAA1B,EAA6B;AACzB,iBAAKJ,aAAL,GAAqBE,aAAaA,aAAaE,MAAb,GAAsB,CAAnC,CAArB;AACA,iBAAKH,SAAL,GAAiB,KAAKI,IAAL,CAAUC,YAAV,CAAuB,KAAKN,aAA5B,CAAjB;AACH;;AAED;AACA,aAAKO,kBAAL,GAA0BV,OAAOU,kBAAjC;AACA,aAAKC,gBAAL,GAAwBX,OAAOW,gBAA/B;;AAEA;AACAC,WAAGC,MAAH,CAAUC,UAAV,CAAqB;AACjBC,kBAAM,SADW;AAEjBC,oBAAQJ,GAAGK,SAAH,CAAaC,MAAb,CAAoBC,QAFX;AAGjBC,oBAAQ,KAAKZ,IAHI;AAIjBa,iBAAK,sBAJY;AAKjBC,yBAAa,KALI;AAMjBC,8BAAkB,KAND;AAOjBC,qBAAS,KAAK3B,WAPG;AAQjB4B,mBAAOb,GAAGK,SAAH,CAAaS,UAAb,CAAwBD,KAAxB,GAAgC,CARtB;AASjBE,oBAAQf,GAAGK,SAAH,CAAaS,UAAb,CAAwBC,MAAxB,GAAiC,CATxB;AAUjBC,0BAAc;AACVC,wBAAQ,KAAKrB,IADH;AAEVJ,2BAAW,KAAKD,aAFN;AAGV2B,iCAAiB,KAAK3B,aAHZ;AAIV4B,yBAAS,KAAKjC,UAAL,GAAkB,eAAlB,GAAoC,IAJnC,CAIyC;AAJzC;AAVG,SAArB;AAiBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,YAAI,KAAKY,kBAAT,EAA6B;AACzB,iBAAKA,kBAAL;AACH;;AAED;AACA,aAAKN,SAAL,CAAeH,OAAf,GAAyB,KAAKA,OAA9B;;AAEA,YAAI,KAAKG,SAAL,CAAe4B,IAAnB,EAAyB;AACrB,iBAAK5B,SAAL,CAAe4B,IAAf,CAAoBhC,MAApB;AACH;AACJ,KA7EoB;;AA+ErBiC,eAAW,qBAAY;AACnB;AACA,YAAI,KAAK7B,SAAL,IAAkB,KAAKA,SAAL,CAAe8B,KAArC,EAA4C;AACxC,iBAAK9B,SAAL,CAAe8B,KAAf;AACH;;AAED,YAAI1C,GAAG2C,OAAH,CAAW,KAAK3B,IAAhB,CAAJ,EAA2B;AACvB,iBAAKA,IAAL,CAAU4B,OAAV;AACH;;AAED,YAAI,KAAKzB,gBAAT,EAA2B;AACvB,iBAAKA,gBAAL;AACH;AACJ;;AA5FoB,CAAT,CAAhB;;AAgGAC,GAAGrB,OAAH,GAAa8C,OAAOC,OAAP,GAAiB/C,OAA9B","file":"PopBase.js","sourceRoot":"../../../../../../assets/scripts/framework/ui","sourcesContent":["/**\n * Created by skyxu on 2019/11/27.\n */\n\nconst PopBase = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        maskOpacity: 255, // 遮罩透明度\n        touchClose: true, // 触摸关闭\n    },\n\n    initBase: function (params, popName) {\n        if (CC_EDITOR) return;\n\n        // 将代码传入的popName作为本模块名称\n        this.popName = popName;\n\n        // 逻辑组件名称\n        this.componentName = null;\n        this.component = null;\n        const popNameSpArr = this.popName.split('/');\n        if (popNameSpArr.length > 0) {\n            this.componentName = popNameSpArr[popNameSpArr.length - 1];\n            this.component = this.node.getComponent(this.componentName);\n        }\n\n        // 开启、关闭回调\n        this.onLaunchedCallback = params.onLaunchedCallback;\n        this.onClosedCallback = params.onClosedCallback;\n\n        // 添加遮罩\n        zy.Button.createNode({\n            name: 'maskBtn',\n            zIndex: zy.constData.ZIndex.POP_MASK,\n            parent: this.node,\n            url: 'textures/common/mask',\n            touchAction: false,\n            commonClickAudio: false,\n            opacity: this.maskOpacity,\n            width: zy.constData.DesignSize.width * 5,\n            height: zy.constData.DesignSize.height * 5,\n            eventHandler: {\n                target: this.node,\n                component: this.componentName,\n                customEventData: this.componentName,\n                handler: this.touchClose ? 'closeCallback' : null, // 操作\n            }\n        });\n        // // 添加遮罩\n        // let btnNode = new cc.Node();\n        // let sp = btnNode.addComponent(cc.Sprite);\n        // cc.loader.loadRes(\"textures/common/mask\", cc.SpriteFrame, (err, spf)=>{\n        //     if (!err) {\n        //         sp.spriteFrame = spf;\n        //         // mark: 需要在这里设置大小\n        //         btnNode.width = zy.constData.DesignSize.width * 2;\n        //         btnNode.height = zy.constData.DesignSize.height * 2;\n        //     }\n        // });\n        // btnNode.name = \"maskBtn\";\n        // btnNode.zIndex = zy.constData.ZIndex.POP_MASK;\n        // btnNode.parent = this.node;\n        // let clickEventHandler = new cc.Component.EventHandler();\n        // clickEventHandler.target = this.node; //这个 node 节点是你的事件处理代码组件所属的节点\n        // clickEventHandler.component = this.componentName;//这个是代码文件名\n        // clickEventHandler.customEventData = this.componentName;\n        // clickEventHandler.handler = this.touchClose ? 'closeCallback' : null; // 操作;\n        // let btn = btnNode.addComponent(cc.Button);\n        // btn.clickEvents.push(clickEventHandler);\n\n        if (this.onLaunchedCallback) {\n            this.onLaunchedCallback();\n        }\n\n        // 初始化pop popName传给控制脚本\n        this.component.popName = this.popName;\n\n        if (this.component.init) {\n            this.component.init(params);\n        }\n    },\n\n    cleanBase: function () {\n        // 释放\n        if (this.component && this.component.clean) {\n            this.component.clean();\n        }\n\n        if (cc.isValid(this.node)) {\n            this.node.destroy();\n        }\n\n        if (this.onClosedCallback) {\n            this.onClosedCallback();\n        }\n    },\n\n});\n\nzy.PopBase = module.exports = PopBase;"]}