{"version":3,"sources":["../../../../../../assets/scripts/framework/ui/assets/scripts/framework/ui/ProgressCircle.js"],"names":["cc","Class","extends","Component","properties","bar","Sprite","progress","default","min","max","notify","_updateProgress","type","Type","FILLED","log","fillRange","setProgressBarToPercent","t","p","cb","unscheduleAllCallbacks","speed","desProgress","progressCb","schedule","updateProgressBar","bind","dt"],"mappings":";;;;;;AAAA;;;;;;;;;;AAUAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;AAELC,gBAAY;AACRC,aAAKL,GAAGM,MADA;AAERC,kBAAU;AACNC,qBAAS,CADH;AAENC,iBAAK,CAFC;AAGNC,iBAAK,CAHC;AAINC,kBAJM,oBAII;AACN,qBAAKC,eAAL;AACH;AANK;AAFF,KAFP;;AAcLA,mBAdK,6BAcc;AACf,YAAI,CAAC,KAAKP,GAAN,IAAa,KAAKA,GAAL,CAASQ,IAAT,IAAiBb,GAAGM,MAAH,CAAUQ,IAAV,CAAeC,MAAjD,EAAyD;AACrDf,eAAGgB,GAAH,CAAO,wBAAP;AACA;AACH;AACD,aAAKX,GAAL,CAASY,SAAT,GAAqB,KAAKV,QAA1B;AACH,KApBI;;;AAsBL;;;;;;AAMAW,2BA5BK,mCA4BmBC,CA5BnB,EA4BsBC,CA5BtB,EA4ByBC,EA5BzB,EA4B6B;AAC9B,YAAIF,KAAK,CAAT,EAAY;AACR,iBAAKZ,QAAL,GAAgBa,CAAhB;AACA,gBAAIC,EAAJ,EAAQ;AACJA;AACH;AACD;AACH;AACD,aAAKC,sBAAL,GAR8B,CAQC;AAC/B,aAAKC,KAAL,GAAa,CAACH,IAAE,KAAKb,QAAR,IAAoBY,CAAjC;AACA,aAAKK,WAAL,GAAmBJ,CAAnB;AACA,aAAKK,UAAL,GAAkBJ,EAAlB;AACA,aAAKK,QAAL,CAAc,KAAKC,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAd,EAAiD,CAAjD;AACH,KAzCI;AA0CLD,qBA1CK,6BA0CaE,EA1Cb,EA0CiB;AAClB,YAAK,KAAKN,KAAL,GAAa,CAAb,IAAkB,KAAKhB,QAAL,GAAgB,KAAKiB,WAAxC,IACI,KAAKD,KAAL,GAAa,CAAb,IAAkB,KAAKhB,QAAL,GAAgB,KAAKiB,WAD/C,EAC6D;AACzD,iBAAKjB,QAAL,IAAiB,KAAKgB,KAAL,GAAaM,EAA9B;AACH,SAHD,MAGO;AACH,iBAAKtB,QAAL,GAAgB,KAAKiB,WAArB;AACA,iBAAKF,sBAAL;AACA,gBAAI,KAAKG,UAAT,EAAqB;AACjB,qBAAKA,UAAL;AACH;AACJ;AACJ;AArDI,CAAT","file":"ProgressCircle.js","sourceRoot":"../../../../../../assets/scripts/framework/ui","sourcesContent":["/**\n * Created by skyxu on 2019/12/27.\n *\n *  圆形进度条\n *  把bar 的填充模式设为 cc.Sprite.Type.FILLED\n *  fillStart系统默认0从右侧为起点，一般我们设置为0.25从正上方为起点开始\n *  fillCenter系统默认是(0, 0)，一般我们设为(0.5, 0.5)\n *\n */\n\ncc.Class({\n    extends: cc.Component,\n    properties: {\n        bar: cc.Sprite,\n        progress: {\n            default: 0,\n            min: 0,\n            max: 1,\n            notify () {\n                this._updateProgress();\n            }\n        }\n    },\n\n    _updateProgress () {\n        if (!this.bar || this.bar.type != cc.Sprite.Type.FILLED) {\n            cc.log(\"圆形进度条的bar必须设为filled模式。\");\n            return;\n        }\n        this.bar.fillRange = this.progress;\n    },\n\n    /**\n     * 设置进度\n     * @param t\n     * @param p\n     * @param cb\n     */\n    setProgressBarToPercent(t, p, cb) {\n        if (t <= 0) {\n            this.progress = p;\n            if (cb) {\n                cb();\n            }\n            return;\n        }\n        this.unscheduleAllCallbacks(); // 若在进度中则停止重新开始\n        this.speed = (p-this.progress) / t;\n        this.desProgress = p;\n        this.progressCb = cb;\n        this.schedule(this.updateProgressBar.bind(this), 0);\n    },\n    updateProgressBar(dt) {\n        if ((this.speed > 0 && this.progress < this.desProgress)\n            || (this.speed < 0 && this.progress > this.desProgress)) {\n            this.progress += this.speed * dt;\n        } else {\n            this.progress = this.desProgress;\n            this.unscheduleAllCallbacks();\n            if (this.progressCb) {\n                this.progressCb();\n            }\n        }\n    }\n});"]}