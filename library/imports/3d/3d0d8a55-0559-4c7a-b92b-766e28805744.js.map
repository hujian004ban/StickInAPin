{"version":3,"sources":["../../../../../../assets/scripts/framework/common/assets/scripts/framework/common/UI.js"],"names":["cc","Class","extends","Component","statics","init","alert","require","loading","tip","seekChildByName","node","name","i","children","child","res","zy","ui","bgScaleAction","params","scale","seq","sequence","scaleTo","easing","easeSineOut","callFunc","callback","runAction","numScaleAction","stopAllActions","easeSineInOut","btnScaleActoin","btnList","btn","btnScale","shakeScreen","times","offsetX","hasOwnProperty","offsetY","ratio","rate","basePosition","position","setPosition","actArray","moveAction","moveBy","v2","easeOut","push","moveAction_1","moveAction_2","backAction","moveTo","flyNode","parent","startPos","endPos","num","cb","convertToNodeSpaceAR","count","instantiate","midPos","add","div","midPosVec","sub","rotate","Math","round","random","desPosVec","PI","desPos","distance","sqrt","pow","x","y","bezierList","bezier","bezierTo","destroy"],"mappings":"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","file":"UI.js","sourceRoot":"../../../../../../assets/scripts/framework/common","sourcesContent":["/**\n * Created by skyxu on 2019/11/28.\n */\n\ncc.Class({\n    extends: cc.Component,\n\n    statics: {\n        init: function () {\n            this.alert = require('Alert');\n            // this.mask = require('mask');\n            this.loading = require('Loading');\n            this.tip = require('Tip');\n        },\n\n        /**\n         * 通用工具\n         * 全场景查找节点\n         */\n        seekChildByName: function (node, name) {\n            if (node.name == name) return node;\n\n            for (const i in node.children) {\n                const child = node.children[i];\n                if (child) {\n                    let res = zy.ui.seekChildByName(child, name);\n                    if (res) return res;\n                }\n            }\n        },\n\n        /**\n         * 通用UI效果\n         */\n        // 背景放大效果\n        bgScaleAction: function (node, params = {}) {\n            node.scale = 0.5;\n            let seq = cc.sequence(\n                cc.scaleTo(0.2, 1.0).easing(cc.easeSineOut()),\n                cc.callFunc(function () {\n                    if (params.callback) params.callback();\n                }),\n            );\n            node.runAction(seq)\n        },\n\n        // 数字放大\n        numScaleAction: function (node, params) {\n            node.stopAllActions();\n            let seq = cc.sequence(\n                cc.scaleTo(0.1, 1.2).easing(cc.easeSineOut()),\n                cc.scaleTo(0.1, 0.8).easing(cc.easeSineInOut()),\n                cc.scaleTo(0.1, 1.1).easing(cc.easeSineInOut()),\n                cc.scaleTo(0.1, 0.95).easing(cc.easeSineInOut()),\n                cc.scaleTo(0.1, 1).easing(cc.easeSineInOut()),\n            );\n            node.runAction(seq)\n        },\n\n        // 按钮缩放效果\n        btnScaleActoin: function (btnList) {\n            for (const i in btnList) {\n                let btn = btnList[i];\n                let btnScale = btn.scale;\n                btn.stopAllActions();\n                btn.scale = btnScale / 4;\n                btn.runAction(cc.sequence(\n                    cc.scaleTo(0.12, btnScale + 0.1),\n                    cc.scaleTo(0.08, btnScale - 0.1),\n                    cc.scaleTo(0.08, btnScale),\n                ));\n            }\n        },\n\n        // 屏幕震动\n        shakeScreen: function (params) {\n            let node = params.node; // 节点\n            let times = params.times ? params.times : 1; // 次数\n            let offsetX = params.hasOwnProperty('offsetX') ? params.offsetX : 20; // 偏移宽度\n            let offsetY = params.hasOwnProperty('offsetY') ? params.offsetY : 20; // 偏移高度\n            let ratio = params.ratio ? params.ratio : 1; // 递增系数\n            let rate = params.rate ? params.rate : 1 / 15; // 帧率\n\n            // 原始Pos\n            let basePosition = node.basePosition ? node.basePosition : node.position;\n            node.stopAllActions();\n            node.setPosition(basePosition);\n\n            node.basePosition = basePosition;\n\n            let actArray = [];\n\n            let moveAction = cc.moveBy(rate, cc.v2(offsetX, offsetY)).easing(cc.easeOut(1.0));\n            actArray.push(moveAction);\n\n            for (let i = 0; i < times - 1; i++) {\n                let moveAction_1 = cc.moveBy(rate, cc.v2(-offsetX * 2, -offsetY * 2)).easing(cc.easeOut(1.0));\n                actArray.push(moveAction_1);\n\n                let moveAction_2 = cc.moveBy(rate, cc.v2(offsetX * 3 / 2, offsetY * 3 / 2)).easing(cc.easeOut(1.0));\n                actArray.push(moveAction_2);\n\n                offsetX = offsetX / ratio;\n                offsetY = offsetY / ratio;\n            }\n\n            let backAction = cc.moveTo(rate, basePosition).easing(cc.easeOut(1.0));\n            actArray.push(backAction);\n\n            node.runAction(cc.sequence(actArray));\n        },\n\n        /**\n         * 创建节点并飞到指定目标点\n         * @param node 要飞的节点（比如金币等,可以是Node或者Prefab)\n         * @param startPos {cc.Vec2} 起点坐标（注意要世界坐标）\n         * @param endPos {cc.Vec2} 终点坐标 （注意要世界坐标）\n         * @param num 创建的数量\n         * @param cb 飞完结束的回调\n         */\n        flyNode: function (node, parent, startPos, endPos, num, cb) {\n            if (num <= 0) {\n                return;\n            }\n            startPos = parent.convertToNodeSpaceAR(startPos);\n            endPos = parent.convertToNodeSpaceAR(endPos);\n            let count = 0;\n            for (let i=0; i<num; i++) {\n                let flyNode = cc.instantiate(node);\n                flyNode.position = startPos;\n                flyNode.parent = parent;\n\n                let midPos = startPos.add(endPos).div(2); // 起始点中心点的坐标\n                let midPosVec = midPos.sub(startPos); // 中心点到起点的向量\n\n                // 向量最多旋转50度，间隔5度一个单位，最多旋转180度\n                let rotate = Math.round(Math.random()*10) * 5 * (Math.random()>0.5?1:-1); // 向量随机旋转角度\n                let desPosVec = midPosVec.rotate(rotate * Math.PI / 180);\n                let desPos = startPos.add(desPosVec);\n                let distance = Math.sqrt(Math.pow(endPos.x-startPos.x, 2) + Math.pow(endPos.y-startPos.y, 2));\n\n                // 执行贝塞尔曲线\n                let bezierList = [desPos, desPos, endPos];\n                let bezier = cc.bezierTo(distance/3000 + Math.random()*0.5, bezierList);\n                let seq = cc.sequence(bezier, cc.callFunc(()=>{\n                    count ++;\n                    if (cb) {\n                        cb (count >= num);\n                    }\n                    flyNode.destroy();\n                }));\n\n                flyNode.runAction(seq);\n            }\n\n        }\n    }\n});"]}