{"version":3,"sources":["Sprite.js"],"names":["Sprite","cc","Class","extends","statics","createNode","params","node","Node","addComponent","zy","updateNode","sprite","getComponent","url","spriteFrame","loadCallback","updateFunc","_spriteFrame","hasOwnProperty","setState","state","srcBlendFactor","dstBlendFactor","isValid","parent","loader","loadRes","SpriteFrame","err","error","module","exports"],"mappings":";;;;;;AAAA;;;;AAIA,IAAMA,SAASC,GAAGC,KAAH,CAAS;AACpBC,aAASF,GAAGD,MADQ;;AAGpBI,aAAS;AACL;AACAC,oBAAY,oBAAUC,MAAV,EAAkB;AAC1B,gBAAIC,OAAO,IAAIN,GAAGO,IAAP,EAAX;AACAD,iBAAKE,YAAL,CAAkBC,GAAGV,MAArB;AACAU,eAAGV,MAAH,CAAUW,UAAV,CAAqBJ,IAArB,EAA2BD,MAA3B;AACA,mBAAOC,IAAP;AACH,SAPI;;AASLI,oBAAY,oBAAUJ,IAAV,EAAgBD,MAAhB,EAAwB;AAChC,gBAAIM,SAASL,KAAKM,YAAL,CAAkBZ,GAAGD,MAArB,CAAb;;AAEA,gBAAIc,MAAMR,OAAOQ,GAAjB;AACA,gBAAIC,cAAcT,OAAOS,WAAzB;AACA,gBAAIC,eAAeV,OAAOU,YAA1B;;AAEA,gBAAIC,aAAa,SAAbA,UAAa,CAAUC,YAAV,EAAwB;AACrC,oBAAIA,YAAJ,EAAkB;AACdN,2BAAOG,WAAP,GAAqBG,YAArB;AACH;AACD;AACA;AACA,oBAAIZ,OAAOa,cAAP,CAAsB,OAAtB,CAAJ,EAAoC;AAChCP,2BAAOQ,QAAP,CAAgBd,OAAOe,KAAvB;AACH;;AAED;AACA,oBAAIf,OAAOgB,cAAX,EAA2B;AACvBV,2BAAOU,cAAP,GAAwBhB,OAAOgB,cAA/B;AACH;;AAED;AACA,oBAAIhB,OAAOiB,cAAX,EAA2B;AACvBX,2BAAOW,cAAP,GAAwBjB,OAAOiB,cAA/B;AACH;;AAED;AACA;AACA,oBAAI,CAACjB,OAAOa,cAAP,CAAsB,QAAtB,CAAD,IAAoClB,GAAGuB,OAAH,CAAWlB,OAAOmB,MAAlB,CAAxC,EAAmE;AAC/Df,uBAAGF,IAAH,CAAQG,UAAR,CAAmBJ,IAAnB,EAAyBD,MAAzB;AACH;AACJ,aAzBD;;AA4BA,gBAAIQ,GAAJ,EAAS;AACNF,uBAAOE,GAAP,GAAaA,GAAb;AACCb,mBAAGyB,MAAH,CAAUC,OAAV,CAAkBb,GAAlB,EAAuBb,GAAG2B,WAA1B,EAAuC,IAAvC,EAA6C,UAACC,GAAD,EAAMd,WAAN,EAAsB;AAC/D,wBAAI,CAACc,GAAL,EAAU;AACN,4BAAI5B,GAAGuB,OAAH,CAAWjB,IAAX,KAAoBK,OAAOE,GAAP,IAAcA,GAAtC,EAA2C;AACvCF,mCAAOG,WAAP,GAAqBA,WAArB;AACAE;AACH;AACJ,qBALD,MAKO;AACHhB,2BAAG6B,KAAH,CAAS,WAAWhB,GAAX,GAAiB,SAA1B;AACH;AACD,wBAAIE,YAAJ,EAAkB;AACdA,qCAAaa,GAAb,EAAkBtB,IAAlB;AACH;AACJ,iBAZD;AAaH,aAfD,MAeO,IAAIQ,WAAJ,EAAiB;AACpBE,2BAAWF,WAAX;AACH,aAFM,MAEA;AACHE;AACH;AACJ;AAhEI;AAHW,CAAT,CAAf;;AAuEAP,GAAGV,MAAH,GAAY+B,OAAOC,OAAP,GAAiBhC,MAA7B","file":"Sprite.js","sourceRoot":"../../../../../../assets/scripts/framework/ui","sourcesContent":["/**\n * Created by skyxu on 2019/11/27.\n */\n\nconst Sprite = cc.Class({\n    extends: cc.Sprite,\n\n    statics: {\n        // 工厂方法\n        createNode: function (params) {\n            let node = new cc.Node();\n            node.addComponent(zy.Sprite);\n            zy.Sprite.updateNode(node, params);\n            return node;\n        },\n\n        updateNode: function (node, params) {\n            let sprite = node.getComponent(cc.Sprite);\n\n            let url = params.url;\n            let spriteFrame = params.spriteFrame;\n            let loadCallback = params.loadCallback;\n\n            let updateFunc = function (_spriteFrame) {\n                if (_spriteFrame) {\n                    sprite.spriteFrame = _spriteFrame;\n                }\n                // cc.Sprite.State.NORMAL : cc.Sprite.State.GRAY // 2.0\n                // cc.Scale9Sprite.state.NORMAL : GRAY : DISTORTION // 1.0\n                if (params.hasOwnProperty('state')) {\n                    sprite.setState(params.state);\n                }\n\n                // 叠加模式\n                if (params.srcBlendFactor) {\n                    sprite.srcBlendFactor = params.srcBlendFactor;\n                }\n\n                // 叠加模式\n                if (params.dstBlendFactor) {\n                    sprite.dstBlendFactor = params.dstBlendFactor;\n                }\n\n                // 再次刷新Node\n                // 创建图片时 父节点已被销毁\n                if (!params.hasOwnProperty('parent') || cc.isValid(params.parent)) {\n                    zy.Node.updateNode(node, params);\n                }\n            };\n\n\n            if (url) {\n               sprite.url = url;\n                cc.loader.loadRes(url, cc.SpriteFrame, null, (err, spriteFrame) => {\n                    if (!err) {\n                        if (cc.isValid(node) && sprite.url == url) {\n                            sprite.spriteFrame = spriteFrame;\n                            updateFunc();\n                        }\n                    } else {\n                        cc.error(\"load: \" + url + \" error.\");\n                    }\n                    if (loadCallback) {\n                        loadCallback(err, node);\n                    }\n                });\n            } else if (spriteFrame) {\n                updateFunc(spriteFrame);\n            } else {\n                updateFunc();\n            }\n        },\n    },\n});\n\nzy.Sprite = module.exports = Sprite;"]}