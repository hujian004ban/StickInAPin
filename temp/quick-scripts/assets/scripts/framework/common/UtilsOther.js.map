{"version":3,"sources":["UtilsOther.js"],"names":["Md5","require","CSVParser","UtilsOther","arrayRmObj","arr","obj","index","indexOf","splice","arrayPopByIdx","array","idx","item","valueInArray","value","len","length","i","arrayRandomValue","num","randomInteger","shuffle","j","temp","Math","floor","random","clearArrayValue","createObjectWithArray","object","arrayToDict","key","dict","data","dictToArray","hasOwnProperty","push","objectToArrayExcludeNumber","opt_arr","opt_exclude","tempArr","isArray","isNumber","toString","splitWithValueType","str","valueType","separator","undefined","split","forEach","currentValue","e","time","parseInt","Date","now","time2second","year","month","day","hour","minute","second","date","n","getTime","getTimeAfterDays","days","cc","assert","getDaysDiff","dateStart","dateEnd","iDays","strDateS","getFullYear","getMonth","getDate","strDateE","abs","getTimeForDay","dateStr","formatTime","s","t","min","sec","slice","getThousandSeparatorString","number","reverse","join","replace","dot","substring","getKMBString","getLastCutOffDay","current","cutOff","_dumpObject","prefix","o","depth","extraBlank","_ignore_function_member","max_depth","D","printWithDepth","txt","blanks","log","getFuncDescriptor","f","type","Object","prototype","call","neb","npfx","prop","i1","i2","dumpObject","DNN","isFunction","isString","Array","isUndefined","isObject","isEmpty","isPrototypeOf","keys","isBoolean","clone","newObj","constructor","copy","getStringFromFile","fileName","sys","isNative","jsb","fileUtils","_loadTxtSync","url","_isNodeJs","xhr","getXMLHttpRequest","timeout","open","test","navigator","userAgent","setRequestHeader","overrideMimeType","send","readyState","status","responseText","fs","readFileSync","bind","loader","getSegmentsInter","a","b","c","d","nx1","y","ny1","x","nx2","ny2","denominator","distC_N2","distA_N2","distB_N2","distA_N1","distC_N1","distD_N1","fraction","dx","dy","getDistance","vec1","vec2","sqrt","pow","loadRemoteImg","callback","isBrowser","load","progress","error","tex","dirpath","getWritablePath","filepath","md5_hex","loadEnd","err","isFileExist","saveFile","Uint8Array","isDirectoryExist","createDirectory","writeDataToFile","XMLHttpRequest","onreadystatechange","responseType","response","checkTouchIsHit","touchPoint","node","rectContainsPoint","getBoundingBoxToWorld","createCliper","spriteName","stencil","Sprite","clippingNode","ClippingNode","attr","anchorX","anchorY","alphaThreshold","convertBoundingBoxToWorld","rect","leftBottom","convertToWorldSpace","p","rightTop","pFromSize","getContentSize","getPositionByAnchor","anchorPoint","bounding","getBoundingBox","width","height","runShakeAction","range","times","runAction","repeat","sequence","moveBy","randomByWeight","keyForWeight","sumWeight","reduce","sumSoFar","tempWeight","randomValue","max","round","parse","options","parser","all","hasNext","ar","nextRow","parseOneLine","bindColumns","rows","colnames","isParseNumber","shift","map","row","isNaN","Number","bindColumnsSimple","CSV","parseOneSimple","module","exports"],"mappings":";;;;AAAA;;;;AAIA;;;;AAEA,IAAIA,MAAMC,QAAQ,kBAAR,CAAV;AACA,IAAIC,YAAYD,QAAQ,aAAR,CAAhB;;AAEA,IAAIE,aAAaA,cAAc,EAA/B;;AAEA;;;;;AAKAA,WAAWC,UAAX,GAAwB,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACxC,QAAIC,QAAQF,IAAIG,OAAJ,CAAYF,GAAZ,CAAZ;AACAD,QAAII,MAAJ,CAAWF,KAAX,EAAiB,CAAjB;AACH,CAHD;;AAKA;;;;;;AAMAJ,WAAWO,aAAX,GAA2B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsB;AAC7C,QAAIC,OAAOF,MAAMC,GAAN,CAAX;AACAD,UAAMF,MAAN,CAAaG,GAAb,EAAkB,CAAlB;;AAEA,WAAOC,IAAP;AACH,CALD;;AAOAV,WAAWW,YAAX,GAA0B,UAAUT,GAAV,EAAeU,KAAf,EAAsB;AAC5C,QAAIC,MAAMX,IAAIY,MAAd;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,GAApB,EAAyBE,GAAzB,EAA8B;AAC1B,YAAIb,IAAIa,CAAJ,KAAUH,KAAd,EAAqB;AACjB,mBAAO,IAAP;AACH;AACJ;AACD,WAAO,KAAP;AACH,CARD;;AAUAZ,WAAWgB,gBAAX,GAA8B,UAAUd,GAAV,EAAe;AACzC,QAAIe,MAAMf,IAAIY,MAAd;AACA,QAAIG,OAAO,CAAX,EAAc;AACV,eAAO,IAAP;AACH;;AAED,QAAIR,MAAMT,WAAWkB,aAAX,CAAyB,CAAzB,EAA4BD,MAAM,CAAlC,CAAV;AACA,WAAOf,IAAIO,GAAJ,CAAP;AACH,CARD;;AAUAT,WAAWmB,OAAX,GAAqB,UAAUjB,GAAV,EAAe;AAChC,QAAIa,UAAJ;AAAA,QACIK,UADJ;AAAA,QAEIC,aAFJ;AAGA,SAAKN,IAAIb,IAAIY,MAAJ,GAAa,CAAtB,EAAyBC,IAAI,CAA7B,EAAgCA,GAAhC,EAAqC;AACjCK,YAAIE,KAAKC,KAAL,CAAWD,KAAKE,MAAL,MAAiBT,IAAI,CAArB,CAAX,CAAJ;AACAM,eAAOnB,IAAIa,CAAJ,CAAP;AACAb,YAAIa,CAAJ,IAASb,IAAIkB,CAAJ,CAAT;AACAlB,YAAIkB,CAAJ,IAASC,IAAT;AACH;AACD,WAAOnB,GAAP;AACH,CAXD;;AAaAF,WAAWyB,eAAX,GAA6B,UAAUjB,KAAV,EAAiBM,MAAjB,EAAyBF,KAAzB,EAAgC;AACzD,SAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAID,MAApB,EAA4BC,GAA5B,EAAiC;AAC7BP,cAAMO,CAAN,IAAWH,KAAX;AACH;AACJ,CAJD;;AAMA;;;;;;AAMAZ,WAAW0B,qBAAX,GAAmC,UAAUlB,KAAV,EAAiBI,KAAjB,EAAwB;AACvD,QAAIe,SAAS,EAAb;AACA,SAAK,IAAIZ,CAAT,IAAcP,KAAd,EAAqB;AACjBmB,eAAOnB,MAAMO,CAAN,CAAP,IAAmBH,KAAnB;AACH;;AAED,WAAOe,MAAP;AACH,CAPD;;AASA3B,WAAW4B,WAAX,GAAyB,UAAUpB,KAAV,EAAiBqB,GAAjB,EAAsB;AAC3C,QAAIC,OAAO,EAAX;AACA,QAAIC,OAAO,IAAX;AACA,SAAK,IAAIhB,CAAT,IAAcP,KAAd,EAAqB;AACjBuB,eAAOvB,MAAMO,CAAN,CAAP;AACAe,aAAKC,KAAKF,GAAL,CAAL,IAAkBE,IAAlB;AACH;AACD,WAAOD,IAAP;AACH,CARD;;AAUA9B,WAAWgC,WAAX,GAAyB,UAAUF,IAAV,EAAgB;AACrC,QAAItB,QAAQ,EAAZ;AACA,SAAK,IAAIqB,GAAT,IAAgBC,IAAhB,EAAsB;AAClB,YAAIA,KAAKG,cAAL,CAAoBJ,GAApB,KAA4BC,KAAKD,GAAL,CAAhC,EAA2C;AACvCrB,kBAAM0B,IAAN,CAAWJ,KAAKD,GAAL,CAAX;AACH;AACJ;AACD,WAAOrB,KAAP;AACH,CARD;;AAUA;;;;;;;AAOAR,WAAWmC,0BAAX,GAAwC,UAAUhC,GAAV,EAAeiC,OAAf,EAAwBC,WAAxB,EAAqC;AACzE,QAAIC,gBAAJ;AACA,QAAIC,QAAQH,OAAR,CAAJ,EAAsB;AAClBE,kBAAUF,OAAV;AACH,KAFD,MAEO;AACHE,kBAAU,EAAV;AACH;AACD,QAAIT,YAAJ;AACA,QAAIW,SAASH,WAAT,CAAJ,EAA2B;AACvB,YAAIhB,OAAOgB,YAAYI,QAAZ,EAAX;AACA,aAAKZ,GAAL,IAAY1B,GAAZ,EAAiB;AACb,gBAAIA,IAAI8B,cAAJ,CAAmBJ,GAAnB,KAA2B1B,IAAI0B,GAAJ,CAA3B,IAAuCR,QAAQQ,GAAnD,EAAwD;AACpDS,wBAAQJ,IAAR,CAAa/B,IAAI0B,GAAJ,CAAb;AACH;AACJ;AACJ,KAPD,MAOO;AACH,aAAKA,GAAL,IAAY1B,GAAZ,EAAiB;AACb,gBAAIA,IAAI8B,cAAJ,CAAmBJ,GAAnB,KAA2B1B,IAAI0B,GAAJ,CAA/B,EAAyC;AACrCS,wBAAQJ,IAAR,CAAa/B,IAAI0B,GAAJ,CAAb;AACH;AACJ;AACJ;;AAED,WAAOS,OAAP;AACH,CAxBD;;AA0BA;;;;;;;AAOAtC,WAAW0C,kBAAX,GAAgC,UAAUC,GAAV,EAAeC,SAAf,EAA0BC,SAA1B,EAAqC;AACjE,QAAIA,cAAcC,SAAlB,EAA6B;AACzBD,oBAAY,GAAZ;AACH;;AAED,QAAI3C,MAAMyC,IAAII,KAAJ,CAAUF,SAAV,CAAV;AACA3C,QAAI8C,OAAJ,CAAY,UAAUC,YAAV,EAAwB7C,KAAxB,EAA+BI,KAA/B,EAAsC;AAC9C,YAAI;AACAA,kBAAMJ,KAAN,IAAewC,UAAWK,YAAX,CAAf;AACH,SAFD,CAEE,OAAOC,CAAP,EAAU;AACR1C,kBAAMJ,KAAN,IAAe,IAAf;AACH;AACJ,KAND;;AAQA,WAAOF,GAAP;AACH,CAfD;;AAiBA;;;;AAIAF,WAAWmD,IAAX,GAAkB,YAAY;AAC1B,WAAOC,SAASC,KAAKC,GAAL,KAAa,MAAtB,CAAP;AACH,CAFD;;AAIA;AACA;;;;;;;;;AASAtD,WAAWuD,WAAX,GAAyB,UAAUC,IAAV,EAAgBC,KAAhB,EAAuBC,GAAvB,EAA4BC,IAA5B,EAAkCC,MAAlC,EAA0CC,MAA1C,EAAkD;AACvE,QAAIC,OAAO,IAAIT,IAAJ,CAASG,IAAT,EAAeC,QAAQ,CAAvB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqCC,MAArC,EAA6CC,MAA7C,CAAX;AACA,QAAIE,IAAID,KAAKE,OAAL,EAAR;AACA,WAAOZ,SAASW,IAAI,MAAb,CAAP;AACH,CAJD;;AAMA;;;;;;AAMA/D,WAAWiE,gBAAX,GAA8B,UAAUd,IAAV,EAAgBe,IAAhB,EAAsB;AAChDC,OAAGC,MAAH,CAAUjB,IAAV,EAAgB,sCAAhB;AACA,QAAIW,OAAO,IAAX;AACA,QAAIK,GAAG3B,QAAH,CAAYW,IAAZ,CAAJ,EAAuB;AACnBW,eAAO,IAAIT,IAAJ,CAASF,OAAO,IAAhB,CAAP;AACH,KAFD,MAEO;AACHW,eAAO,IAAIT,IAAJ,CAASF,IAAT,CAAP;AACH;AACD,WAAO,IAAIE,IAAJ,CAASS,KAAKE,OAAL,KAAiBE,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,IAAhD,CAAP;AACH,CATD;;AAWA;;;;;;AAMAlE,WAAWqE,WAAX,GAAyB,UAAUC,SAAV,EAAqBC,OAArB,EAA8B;AACnDJ,OAAGC,MAAH,CAAUE,aAAaC,OAAvB,EAAgC,qCAAhC;AACA,QAAIC,KAAJ;AACA,QAAIxE,WAAWwC,QAAX,CAAoB8B,SAApB,CAAJ,EAAoC;AAChCA,oBAAY,IAAIjB,IAAJ,CAASiB,YAAY,IAArB,CAAZ;AACH,KAFD,MAEO;AACHA,oBAAY,IAAIjB,IAAJ,CAASiB,SAAT,CAAZ;AACH;AACD,QAAItE,WAAWwC,QAAX,CAAoB+B,OAApB,CAAJ,EAAkC;AAC9BA,kBAAU,IAAIlB,IAAJ,CAASkB,UAAU,IAAnB,CAAV;AACH,KAFD,MAEO;AACHA,kBAAU,IAAIlB,IAAJ,CAASkB,OAAT,CAAV;AACH;;AAED,QAAIE,WAAW,IAAIpB,IAAJ,CAASiB,UAAUI,WAAV,EAAT,EAAkCJ,UAAUK,QAAV,EAAlC,EAAwDL,UAAUM,OAAV,EAAxD,CAAf;AACA,QAAIC,WAAW,IAAIxB,IAAJ,CAASkB,QAAQG,WAAR,EAAT,EAAgCH,QAAQI,QAAR,EAAhC,EAAoDJ,QAAQK,OAAR,EAApD,CAAf;AACAJ,YAAQpB,SAAS9B,KAAKwD,GAAL,CAASD,WAAWJ,QAApB,IAAgC,IAAhC,GAAuC,EAAvC,GAA4C,EAA5C,GAAiD,EAA1D,CAAR,CAhBmD,CAgBsB;AACzED,aAAUK,YAAYJ,QAAZ,GAAuB,CAAvB,GAA2B,CAAC,CAAtC;AACA;AACA,WAAOD,KAAP;AACH,CApBD;;AAsBA;;;;;AAKAxE,WAAW+E,aAAX,GAA2B,UAAUjB,IAAV,EAAgB;AACvC,QAAI,CAACA,IAAL,EAAW;AACPA,eAAO,IAAIT,IAAJ,EAAP;AACH,KAFD,MAEO,IAAIc,GAAG3B,QAAH,CAAYsB,IAAZ,CAAJ,EAAuB;AAC1BA,eAAO,IAAIT,IAAJ,CAASS,OAAO,IAAhB,CAAP;AACH,KAFM,MAEA;AACHA,eAAO,IAAIT,IAAJ,CAASS,IAAT,CAAP;AACH;AACD,QAAIN,OAAOM,KAAKY,WAAL,EAAX;AACA,QAAIjB,QAAQK,KAAKa,QAAL,KAAkB,CAAlB,GAAsB,EAAtB,GAA2B,OAAOb,KAAKa,QAAL,KAAkB,CAAzB,CAA3B,GACNb,KAAKa,QAAL,KAAkB,CADxB;AAEA,QAAIjB,MAAMI,KAAKc,OAAL,KAAiB,EAAjB,GAAsB,MAAMd,KAAKc,OAAL,EAA5B,GAA6Cd,KAClDc,OADkD,EAAvD;AAEA,QAAII,UAAUxB,OAAO,GAAP,GAAaC,KAAb,GAAqB,GAArB,GAA2BC,GAAzC;AACA,WAAOsB,OAAP;AACH,CAfD;;AAkBA;;;;;AAKAhF,WAAWiF,UAAX,GAAwB,UAAUC,CAAV,EAAa;AACjC,QAAIC,UAAJ;AACA,QAAID,KAAK,CAAT,EAAY;AACR,YAAIvB,OAAOrC,KAAKC,KAAL,CAAW2D,IAAI,IAAf,CAAX;AACA,YAAIE,MAAM9D,KAAKC,KAAL,CAAW2D,IAAI,EAAf,IAAqB,EAA/B;AACA,YAAIG,MAAMH,IAAI,EAAd;AACA,YAAIxB,MAAMN,SAASO,OAAO,EAAhB,CAAV;AACA,YAAID,OAAO,CAAX,EAAc;AACV,mBAAOA,MAAM,MAAb;AACH;AACD,YAAIA,MAAM,CAAV,EAAa;AACT,mBAAOA,MAAM,OAAb;AACH;;AAED,YAAIA,MAAM,CAAV,EAAa;AACTC,mBAAOA,OAAO,KAAKD,GAAnB;AACAyB,gBAAIzB,MAAM,MAAN,GAAe,CAAC,OAAOC,IAAR,EAAc2B,KAAd,CAAoB,CAAC,CAArB,CAAf,GAAyC,GAA7C;AACH,SAHD,MAIK,IAAI3B,OAAO,CAAX,EAAc;AACfwB,gBAAI,CAAC,OAAOxB,IAAR,EAAc2B,KAAd,CAAoB,CAAC,CAArB,IAA0B,GAA9B;AACH,SAFI,MAEE;AACHH,gBAAI,EAAJ;AACH;;AAED,YAAIC,MAAM,EAAV,EAAc;AACVD,iBAAK,GAAL;AACH;AACDA,aAAKC,MAAM,GAAX;AACA,YAAIC,MAAM,EAAV,EAAc;AACVF,iBAAK,GAAL;AACH;AACDA,aAAK/B,SAASiC,GAAT,CAAL;AACH;AACD,WAAOF,CAAP;AACH,CAlCD;;AAoCA;;;;;AAKAnF,WAAWuF,0BAAX,GAAwC,UAAUC,MAAV,EAAkB;;AAEtD;AACA;AACA,QAAI7C,MAAM6C,OAAO/C,QAAP,GAAkBM,KAAlB,CAAwB,EAAxB,EAA4B0C,OAA5B,GAAsCC,IAAtC,CAA2C,EAA3C,EAA+CC,OAA/C,CAAuD,2BAAvD,EAAoF,KAApF,EAA2F5C,KAA3F,CAAiG,EAAjG,EAAqG0C,OAArG,GAA+GC,IAA/G,CAAoH,EAApH,CAAV;AACA,QAAIE,MAAMjD,IAAItC,OAAJ,CAAY,GAAZ,CAAV;AACA,QAAIuF,OAAO,CAAX,EAAc;AACVjD,cAAMA,IAAIkD,SAAJ,CAAc,CAAd,EAAiBD,MAAM,CAAvB,CAAN;AACH;AACD,WAAOjD,GAAP;AACH,CAVD;;AAYA3C,WAAW8F,YAAX,GAA0B,UAAUN,MAAV,EAAkB;AACxC,QAAI,CAAC,KAAKhD,QAAL,CAAcgD,MAAd,CAAL,EAA4B;AACxB,eAAOA,MAAP;AACH;;AAED,QAAIA,SAAS,UAAT,IAAuB,CAA3B,EAA8B;AAC1B,eAAO,KAAKD,0BAAL,CAAgCC,SAAS,UAAzC,IAAuD,GAA9D;AACH,KAFD,MAGK,IAAIA,SAAS,OAAT,IAAoB,CAAxB,EAA2B;AAC5B,eAAO,KAAKD,0BAAL,CAAgCC,SAAS,OAAzC,IAAoD,GAA3D;AACH;AACD;AAHK,SAIA,IAAIA,SAAS,KAAT,IAAkB,CAAtB,EAAyB;AAC1B,mBAAO,KAAKD,0BAAL,CAAgCC,SAAS,IAAzC,IAAiD,GAAxD;AACH;AACD,WAAO,KAAKD,0BAAL,CAAgCC,MAAhC,CAAP;AACH,CAhBD;;AAkBA;;;;;;AAMAxF,WAAW+F,gBAAX,GAA8B,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AACrD,QAAI9C,OAAO8C,SAASD,OAApB;AACA,QAAI7C,OAAO,CAAX,EAAc,OAAO,CAAC,CAAR;AACdA,WAAOC,SAASD,QAAQ,KAAK,IAAb,CAAT,CAAP;AACA,WAAOA,IAAP;AACH,CALD;;AAOAnD,WAAWkG,WAAX,GAAyB,UAAUC,MAAV,EAAkBC,CAAlB,EAAqBC,KAArB,EAA4BC,UAA5B,EAAwCC,uBAAxC,EAAiEC,SAAjE,EAA4E;AACjG,QAAIxG,WAAWyG,CAAX,CAAaD,SAAb,KAA2BH,QAAQG,SAAvC,EAAkD;AAC9C;AACH;;AAED,aAASE,cAAT,CAAwBC,GAAxB,EAA6BN,KAA7B,EAAoCC,UAApC,EAAgD;AAC5C,eAAOD,QAAQ,CAAf,EAAkB;AACdM,kBAAM,OAAOA,GAAb;AACA,cAAEN,KAAF;AACH;AACD,YAAIC,aAAa,CAAjB,EAAoB;AAChB,gBAAIM,UAAS,EAAb;AACA,gBAAI7F,UAAJ;AACA,iBAAKA,IAAI,CAAT,EAAYA,IAAIuF,UAAhB,EAA4B,EAAEvF,CAA9B,EAAiC;AAC7B6F,2BAAU,GAAV;AACH;AACDD,kBAAMC,UAASD,GAAf;AACH;AACDxC,WAAG0C,GAAH,CAAOF,GAAP;AACH;;AAED,aAASG,iBAAT,CAA2BC,CAA3B,EAA8B;AAC1B,eAAQA,EAAEtE,QAAF,GAAakD,OAAb,CAAqB,eAArB,EAAsC,EAAtC,EAA0C5C,KAA1C,CAAgD,GAAhD,CAAD,CAAuD,CAAvD,IAA4D,GAAnE;AACH;;AAED,QAAIiE,OAAOC,OAAOC,SAAP,CAAiBzE,QAAjB,CAA0B0E,IAA1B,CAA+Bf,CAA/B,EAAkCd,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAX;AACA,QAAIH,UAAJ;AACA,QAAIiC,YAAJ;AACA,QAAIC,aAAJ;AACA,QAAIxG,YAAJ;AACA,QAAI+F,eAAJ;AACA,YAAQI,IAAR;AACI,aAAK,QAAL;AACA,aAAK,QAAL;AACI7B,gBAAI,OAAOiB,EAAE3D,QAAF,EAAP,GAAsB,IAA1B;AACA,gBAAI0D,MAAJ,EAAY;AACRhB,oBAAIgB,SAAShB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;AACA;AACJ,aAAK,WAAL;AACInB,gBAAI,YAAJ;AACA,gBAAIgB,MAAJ,EAAY;AACRhB,oBAAIgB,SAAShB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;AACA;AACJ,aAAK,SAAL;;AAEInB,gBAAIiB,EAAE3D,QAAF,EAAJ;AACA,gBAAI0D,MAAJ,EAAY;AACRhB,oBAAIgB,SAAShB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;;AAEA;AACJ,aAAK,QAAL;;AAEInB,gBAAI,GAAJ;AACA,gBAAIgB,MAAJ,EAAY;AACRhB,oBAAIgB,SAAShB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;AACA,gBAAIgB,aAAJ;AACA,iBAAKA,IAAL,IAAalB,CAAb,EAAgB;AACZ,oBAAI,CAACA,EAAEnE,cAAF,CAAiBqF,IAAjB,CAAL,EAA6B;AACzB;AACH;AACDD,uBAAO,OAAOC,IAAP,GAAc,OAArB;AACAF,sBAAM,CAACjB,SAASA,OAAOrF,MAAhB,GAAyB,CAA1B,IAA+B,CAA/B,GAAmCwF,UAAzC;AACAJ,4BAAYmB,IAAZ,EAAkBjB,EAAEkB,IAAF,CAAlB,EAA2BjB,QAAQ,CAAnC,EAAsCe,GAAtC,EAA2Cb,uBAA3C,EAAoEC,SAApE;AACH;;AAED3F,kBAAMsF,SAASA,OAAOrF,MAAhB,GAAyB,CAA/B;AACAqE,gBAAI,GAAJ;AACA,gBAAItE,MAAM,CAAV,EAAa;AACT+F,yBAAS,EAAT;AACA,oBAAIW,WAAJ;AACA,qBAAKA,KAAK,CAAV,EAAaA,KAAK1G,GAAlB,EAAuB,EAAE0G,EAAzB,EAA6B;AACzBX,8BAAU,GAAV;AACH;AACDzB,oBAAIyB,SAASzB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;;AAEA;AACJ,aAAK,OAAL;;AAEInB,gBAAI,GAAJ;AACA,gBAAIgB,MAAJ,EAAY;AACRhB,oBAAIgB,SAAShB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;AACA,gBAAIkB,WAAJ;AACA,iBAAKA,KAAK,CAAV,EAAaA,KAAKpB,EAAEtF,MAApB,EAA4B,EAAE0G,EAA9B,EAAkC;AAC9BH,uBAAOG,KAAK,KAAZ;AACAJ,sBAAM,CAACjB,SAASA,OAAOrF,MAAhB,GAAyB,CAA1B,IAA+B,CAA/B,GAAmCwF,UAAzC;AACAJ,4BAAYmB,IAAZ,EAAkBjB,EAAEoB,EAAF,CAAlB,EAAyBnB,QAAQ,CAAjC,EAAoCe,GAApC,EAAyCb,uBAAzC,EAAkEC,SAAlE;AACH;;AAED3F,kBAAMsF,SAASA,OAAOrF,MAAhB,GAAyB,CAA/B;AACAqE,gBAAI,GAAJ;AACA,gBAAItE,MAAM,CAAV,EAAa;AACT+F,yBAAS,EAAT;AACA,oBAAI7F,UAAJ;AACA,qBAAKA,IAAI,CAAT,EAAYA,IAAIF,GAAhB,EAAqB,EAAEE,CAAvB,EAA0B;AACtB6F,8BAAU,GAAV;AACH;AACDzB,oBAAIyB,SAASzB,CAAb;AACH;AACDuB,2BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;;AAEA;AACJ,aAAK,UAAL;;AAEI,gBAAI,CAACC,uBAAL,EAA8B;AAC1BpB,oBAAI2B,kBAAkBV,CAAlB,CAAJ;AACA,oBAAID,MAAJ,EAAY;AACRhB,wBAAIgB,SAAShB,CAAb;AACH;AACDuB,+BAAevB,CAAf,EAAkBkB,KAAlB,EAAyBC,UAAzB;AACH;AACD;AA3FR;AA6FH,CA5HD;;AA8HA;;;;;;AAMAtG,WAAWyH,UAAX,GAAwB,UAAUrB,CAAV,EAAaG,uBAAb,EAAsCC,SAAtC,EAAiD;AACrExG,eAAWkG,WAAX,CAAuBpD,SAAvB,EAAkCsD,CAAlC,EAAqC,CAArC,EAAwC,CAAxC,EAA2CG,2BAA2B,KAAtE,EAA6EC,SAA7E;AACH,CAFD;;AAIA;;;;;AAKAxG,WAAWyG,CAAX,GAAe,UAAUtG,GAAV,EAAe;AAC1B,WAAOA,QAAQ2C,SAAf;AACH,CAFD;;AAIA;;;;;AAKA9C,WAAW0H,GAAX,GAAiB,UAAUvH,GAAV,EAAe;AAC5B,WAAOA,QAAQ2C,SAAR,IAAqB3C,QAAQ,IAApC;AACH,CAFD;;AAIA;;;;;AAKAH,WAAW2H,UAAX,GAAwB,UAAUxH,GAAV,EAAe;AACnC,WAAO,OAAOA,GAAP,KAAe,UAAtB;AACH,CAFD;;AAIA;;;;;AAKAH,WAAWwC,QAAX,GAAsB,UAAUrC,GAAV,EAAe;AACjC,WAAO,OAAOA,GAAP,KAAe,QAAf,IAA2B8G,OAAOC,SAAP,CAAiBzE,QAAjB,CAA0B0E,IAA1B,CAA+BhH,GAA/B,MAAwC,iBAA1E;AACH,CAFD;;AAIA;;;;;AAKAH,WAAW4H,QAAX,GAAsB,UAAUzH,GAAV,EAAe;AACjC,WAAO,OAAOA,GAAP,KAAe,QAAf,IAA2B8G,OAAOC,SAAP,CAAiBzE,QAAjB,CAA0B0E,IAA1B,CAA+BhH,GAA/B,MAAwC,iBAA1E;AACH,CAFD;;AAIAH,WAAWuC,OAAX,GAAqB,UAAUpC,GAAV,EAAe;AAChC,WAAO0H,MAAMtF,OAAN,CAAcpC,GAAd,KACF,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAf,IAA2B8G,OAAOC,SAAP,CAAiBzE,QAAjB,CAA0B0E,IAA1B,CAA+BhH,GAA/B,MAAwC,gBADxE;AAGH,CAJD;;AAMA;;;;;AAKAH,WAAW8H,WAAX,GAAyB,UAAU3H,GAAV,EAAe;AACpC,WAAOA,QAAQ2C,SAAf;AACH,CAFD;;AAIA;;;;;AAKA9C,WAAW+H,QAAX,GAAsB,UAAU5H,GAAV,EAAe;AACjC,WAAO,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAf,IAA2B8G,OAAOC,SAAP,CAAiBzE,QAAjB,CAA0B0E,IAA1B,CAA+BhH,GAA/B,MAAwC,iBAA1E;AACH,CAFD;;AAIA;;;;;AAKAH,WAAWgI,OAAX,GAAqB,UAAU7H,GAAV,EAAe;AAChC,WAAQ0H,MAAMtF,OAAN,CAAcpC,GAAd,KAAsBA,IAAIW,MAAJ,KAAe,CAAtC,IACCmG,OAAOC,SAAP,CAAiBe,aAAjB,CAA+B9H,GAA/B,KAAuC8G,OAAOiB,IAAP,CAAY/H,GAAZ,EAAiBW,MAAjB,KAA4B,CAD3E;AAEH,CAHD;;AAKA;;;;;AAKAd,WAAWmI,SAAX,GAAuB,UAAUhI,GAAV,EAAe;AAClC,WAAOA,QAAQ,IAAR,IAAgBA,QAAQ,KAAxB,IAAiC8G,OAAOC,SAAP,CAAiBzE,QAAjB,CAA0B0E,IAA1B,CAA+BhH,GAA/B,MAAwC,kBAAhF;AACH,CAFD;;AAIA;;;;;;;AAOAH,WAAWoI,KAAX,GAAmB,UAAUjI,GAAV,EAAekI,MAAf,EAAuB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAI,CAACA,MAAL,EAAa;AACTA,iBAAUlI,IAAImI,WAAL,GAAoB,IAAInI,IAAImI,WAAR,EAApB,GAA4C,EAArD;AACH;;AAED;AACA;AACA;AACA;AACA;AACA,QAAIzG,YAAJ;AACA,QAAI0G,aAAJ;AACA,SAAK1G,GAAL,IAAY1B,GAAZ,EAAiB;AACb,YAAI,CAACA,IAAI8B,cAAJ,CAAmBJ,GAAnB,CAAL,EAA8B;AAC1B;AACH;AACD0G,eAAOpI,IAAI0B,GAAJ,CAAP;AACA;AACA,YAAK,QAAQ0G,IAAR,yCAAQA,IAAR,OAAkB,QAAnB,IAAgCA,IAApC,EAA0C;AACtCF,mBAAOxG,GAAP,IAAc7B,WAAWoI,KAAX,CAAiBG,IAAjB,EAAuB,IAAvB,CAAd;AACH,SAFD,MAEO;AACHF,mBAAOxG,GAAP,IAAc0G,IAAd;AACH;AACJ;AACD,WAAOF,MAAP;AACH,CA1CD;;AA4CA;;AAEA;;;;;AAKArI,WAAWwI,iBAAX,GAA+B,UAAUC,QAAV,EAAoB;AAC/C,QAAItE,GAAGuE,GAAH,CAAOC,QAAX,EAAqB;AACjB,eAAOC,IAAIC,SAAJ,CAAcL,iBAAd,CAAgCC,QAAhC,CAAP;AACH,KAFD,MAEO;AACH,YAAIK,eAAe,UAAUC,GAAV,EAAe;AAC9B,gBAAI,CAAC5E,GAAG6E,SAAR,EAAmB;AACf,oBAAIC,MAAM,KAAKC,iBAAL,EAAV;AACAD,oBAAIE,OAAJ,GAAc,CAAd;AACAF,oBAAIG,IAAJ,CAAS,KAAT,EAAgBL,GAAhB,EAAqB,KAArB;AACA,oBAAI,QAAQM,IAAR,CAAaC,UAAUC,SAAvB,KAAqC,CAAC,SAASF,IAAT,CAAcC,UAAUC,SAAxB,CAA1C,EAA8E;AAC1E;AACAN,wBAAIO,gBAAJ,CAAqB,gBAArB,EAAuC,OAAvC;AACH,iBAHD,MAGO;AACH,wBAAIP,IAAIQ,gBAAR,EAA0BR,IAAIQ,gBAAJ,CAAqB,4BAArB;AAC7B;AACDR,oBAAIS,IAAJ,CAAS,IAAT;AACA,oBAAI,CAACT,IAAIU,UAAL,KAAoB,CAApB,IAAyBV,IAAIW,MAAJ,KAAe,GAA5C,EAAiD;AAC7C,2BAAO,IAAP;AACH;AACD,uBAAOX,IAAIY,YAAX;AACH,aAfD,MAeO;AACH,oBAAIC,KAAKhK,QAAQ,IAAR,CAAT;AACA,uBAAOgK,GAAGC,YAAH,CAAgBhB,GAAhB,EAAqBtG,QAArB,EAAP;AACH;AACJ,SApBkB,CAoBjBuH,IApBiB,CAoBZ7F,GAAG8F,MApBS,CAAnB;;AAsBA,eAAOnB,aAAaL,QAAb,CAAP;AACH;AACJ,CA5BD;;AA8BA;;;;;;;;AAQAzI,WAAWkK,gBAAX,GAA8B,UAAUC,CAAV,EAAaC,CAAb,EAAgBC,CAAhB,EAAmBC,CAAnB,EAAsB;AAChD;AACA,QAAIC,MAAOH,EAAEI,CAAF,GAAML,EAAEK,CAAnB;AAAA,QAAuBC,MAAON,EAAEO,CAAF,GAAMN,EAAEM,CAAtC;;AAEA;AACA,QAAIC,MAAOL,EAAEE,CAAF,GAAMH,EAAEG,CAAnB;AAAA,QAAuBI,MAAOP,EAAEK,CAAF,GAAMJ,EAAEI,CAAtC;;AAEA;AACA,QAAIG,cAAcN,MAAIK,GAAJ,GAAUH,MAAIE,GAAhC;AACA,QAAIE,eAAa,CAAjB,EAAoB;AAChB,eAAO,KAAP;AACH;;AAED;AACA,QAAIC,WAASH,MAAMN,EAAEK,CAAR,GAAYE,MAAMP,EAAEG,CAAjC;AACA,QAAIO,WAASJ,MAAMR,EAAEO,CAAR,GAAYE,MAAMT,EAAEK,CAApB,GAAsBM,QAAnC;AACA,QAAIE,WAASL,MAAMP,EAAEM,CAAR,GAAYE,MAAMR,EAAEI,CAApB,GAAsBM,QAAnC;;AAEA;AACA,QAAKC,WAASC,QAAT,IAAmB,CAAxB,EAA6B;AACzB,eAAO,KAAP;AACH;;AAED;AACA;AACA;AACA;AACA,QAAIC,WAASV,MAAMJ,EAAEO,CAAR,GAAYD,MAAMN,EAAEK,CAAjC;AACA,QAAIU,WAASX,MAAMF,EAAEK,CAAR,GAAYD,MAAMJ,EAAEG,CAApB,GAAsBS,QAAnC;AACA,QAAIE,WAASZ,MAAMD,EAAEI,CAAR,GAAYD,MAAMH,EAAEE,CAApB,GAAsBS,QAAnC;AACA,QAAKC,WAASC,QAAT,IAAmB,CAAxB,EAA6B;AACzB,eAAO,KAAP;AACH;;AAED;AACA,QAAIC,WAAUL,WAAWF,WAAzB;AACA,QAAIQ,KAAID,WAAWX,GAAnB;AAAA,QACIa,KAAI,CAACF,QAAD,GAAYb,GADpB;AAEA,WAAO,EAAEG,GAAGP,EAAEO,CAAF,GAAMW,EAAX,EAAgBb,GAAGL,EAAEK,CAAF,GAAMc,EAAzB,EAAP;AACH,CAvCD;;AAyCAtL,WAAWuL,WAAX,GAAyB,UAASC,IAAT,EAAeC,IAAf,EAAqB;AAC1C,QAAInB,IAAIhJ,KAAKoK,IAAL,CAAUpK,KAAKqK,GAAL,CAASF,KAAKf,CAAL,GAAOc,KAAKd,CAArB,EAAwB,CAAxB,IAA6BpJ,KAAKqK,GAAL,CAASF,KAAKjB,CAAL,GAAOgB,KAAKhB,CAArB,EAAwB,CAAxB,CAAvC,CAAR;AACA,WAAOF,CAAP;AACH,CAHD;;AAKA;;;;;AAKAtK,WAAW4L,aAAX,GAA2B,UAAU7C,GAAV,EAAe8C,QAAf,EAAyB;AAChD,QAAI1H,GAAGuE,GAAH,CAAOoD,SAAX,EAAqB;AACjB3H,WAAG0C,GAAH,CAAO,qBAAP;AACA1C,WAAG8F,MAAH,CAAU8B,IAAV,CAAehD,GAAf,EAAmB,UAASiD,QAAT,EAAkB;AACjC7H,eAAG0C,GAAH,CAAO,8BAA4BmF,QAAnC;AACH,SAFD,EAEE,UAASC,KAAT,EAAeC,GAAf,EAAmB;AACjB,gBAAGD,KAAH,EACA;AACI9H,mBAAG0C,GAAH,CAAO,2BAAyBoF,KAAhC;AACA;AACH;AACD9H,eAAG0C,GAAH,CAAO,0BAAP;AACAgF,qBAASK,GAAT;AACH,SAVD;;AAYA;AACH;;AAED/H,OAAG0C,GAAH,CAAO,yBAAP;AACA,QAAIsF,UAAUvD,IAAIC,SAAJ,CAAcuD,eAAd,KAAkC,MAAhD;AACA,QAAIC,WAAWF,UAAUtM,IAAIyM,OAAJ,CAAYvD,GAAZ,CAAV,GAA6B,MAA5C;;AAEA,aAASwD,OAAT,GAAmB;AACfpI,WAAG8F,MAAH,CAAU8B,IAAV,CAAeM,QAAf,EAAyB,UAAUG,GAAV,EAAeN,GAAf,EAAoB;AACzC,gBAAIM,GAAJ,EAAS;AACLrI,mBAAG8H,KAAH,CAASO,GAAT;AACH,aAFD,MAEO;AACHX,yBAASK,GAAT;AACH;AACJ,SAND;AAQH;;AAED,QAAItD,IAAIC,SAAJ,CAAc4D,WAAd,CAA0BJ,QAA1B,CAAJ,EAAyC;AACrClI,WAAG0C,GAAH,CAAO,mBAAmBwF,QAA1B;AACAE;AACA;AACH;;AAED,QAAIG,WAAW,SAAXA,QAAW,CAAU3K,IAAV,EAAgB;AAC3BoC,WAAG0C,GAAH,QAAc9E,IAAd,yCAAcA,IAAd;AACAoC,WAAG0C,GAAH,CAAO9E,IAAP;AACA,YAAIqI,IAAI,IAAIuC,UAAJ,CAAe5K,IAAf,CAAR;AACAoC,WAAG0C,GAAH,QAAcuD,CAAd,yCAAcA,CAAd;AACAjG,WAAG0C,GAAH,CAAOuD,EAAEtJ,MAAT;AACA,YAAI,OAAOiB,IAAP,KAAgB,WAApB,EAAiC;AAC7B,gBAAI,CAAC6G,IAAIC,SAAJ,CAAc+D,gBAAd,CAA+BT,OAA/B,CAAL,EAA8C;AAC1CvD,oBAAIC,SAAJ,CAAcgE,eAAd,CAA8BV,OAA9B;AACH;AACDhI,eAAG0C,GAAH,CAAO,WAAWwF,QAAlB;AACA,gBAAIzD,IAAIC,SAAJ,CAAciE,eAAd,CAA8B,IAAIH,UAAJ,CAAe5K,IAAf,CAA9B,EAAoDsK,QAApD,CAAJ,EAAmE;AAC/DlI,mBAAG0C,GAAH,CAAO,0BAAP;AACA1C,mBAAG0C,GAAH,CAAO,OAAP;;AAEA0F;AACH,aALD,MAKO;AACHpI,mBAAG0C,GAAH,CAAO,yBAAP;AACH;AACJ,SAbD,MAaO;AACH1C,eAAG0C,GAAH,CAAO,6BAAP;AACH;AACJ,KAtBD;;AAwBA,QAAIoC,MAAM,IAAI8D,cAAJ,EAAV;AACA9D,QAAI+D,kBAAJ,GAAyB,YAAY;AACjC7I,WAAG0C,GAAH,CAAO,qBAAqBoC,IAAIU,UAAhC;AACAxF,WAAG0C,GAAH,CAAO,iBAAiBoC,IAAIW,MAA5B;AACA,YAAIX,IAAIU,UAAJ,KAAmB,CAAvB,EAA0B;AACtB,gBAAIV,IAAIW,MAAJ,KAAe,GAAnB,EAAwB;AACpBX,oBAAIgE,YAAJ,GAAmB,aAAnB;AACAP,yBAASzD,IAAIiE,QAAb;AACH,aAHD,MAGO;AACHR,yBAAS,IAAT;AACH;AACJ;AACJ,KAXwB,CAWvB1C,IAXuB,CAWlB,IAXkB,CAAzB;AAYAf,QAAIG,IAAJ,CAAS,KAAT,EAAgBL,GAAhB,EAAqB,IAArB;AACAE,QAAIS,IAAJ;AACH,CA9ED;;AAgFA;;;;;;AAMA1J,WAAWmN,eAAX,GAA6B,UAAUC,UAAV,EAAsBC,IAAtB,EAA4B;AACrD,WAAOlJ,GAAGmJ,iBAAH,CAAqBD,KAAKE,qBAAL,EAArB,EAAmDH,UAAnD,CAAP;AACH,CAFD;;AAIA;;;;;AAKApN,WAAWwN,YAAX,GAA0B,UAAUC,UAAV,EAAsB;AAC5C;AACA,QAAIC,UAAU,IAAIvJ,GAAGwJ,MAAP,CAAcF,UAAd,CAAd;AACA;AACA,QAAIG,eAAe,IAAIzJ,GAAG0J,YAAP,EAAnB;AACAD,iBAAaE,IAAb,CAAkB;AACdJ,iBAASA,OADK;AAEdK,iBAAS,GAFK;AAGdC,iBAAS,GAHK;AAIdC,wBAAgB,GAJF,CAIM;AAJN,KAAlB;;AAOA,WAAOL,YAAP;AACH,CAbD;;AAeA;AACA;;;;;AAKA5N,WAAWkO,yBAAX,GAAuC,UAAUb,IAAV,EAAgB;AACnD,QAAI,CAACA,IAAL,EAAW;AACP,eAAOlJ,GAAGgK,IAAH,EAAP;AACH;;AAED,QAAIC,aAAaf,KAAKgB,mBAAL,CAAyBlK,GAAGmK,CAAH,EAAzB,CAAjB;AACA,QAAIC,WAAWlB,KAAKgB,mBAAL,CAAyBlK,GAAGqK,SAAH,CAAanB,KAAKoB,cAAL,EAAb,CAAzB,CAAf;;AAEA,WAAOtK,GAAGgK,IAAH,CAAQC,WAAW1D,CAAnB,EAAsB0D,WAAW5D,CAAjC,EAAoC+D,SAAS7D,CAAT,GAAa0D,WAAW1D,CAA5D,EAA+D6D,SAAS/D,CAAT,GAAa4D,WAAW5D,CAAvF,CAAP;AACH,CATD;;AAWA;;;;;;AAMAxK,WAAW0O,mBAAX,GAAiC,UAAUrB,IAAV,EAAgBsB,WAAhB,EAA6B;AAC1D,QAAI,CAACtB,IAAL,EAAW;AACP,eAAOlJ,GAAGmK,CAAH,EAAP;AACH;;AAED,QAAIM,WAAWvB,KAAKwB,cAAL,EAAf;AACAD,aAASlE,CAAT,IAAckE,SAASE,KAAT,GAAiBH,YAAYjE,CAA3C;AACAkE,aAASpE,CAAT,IAAcoE,SAASG,MAAT,GAAkBJ,YAAYnE,CAA5C;AACA,WAAOrG,GAAGmK,CAAH,CAAKM,SAASlE,CAAd,EAAiBkE,SAASpE,CAA1B,CAAP;AACH,CATD;;AAWA;;;;;;AAMAxK,WAAWgP,cAAX,GAA4B,UAAU3B,IAAV,EAAgB4B,KAAhB,EAAuBC,KAAvB,EAA8B;AACtD7B,SAAK8B,SAAL,CAAehL,GAAGiL,MAAH,CACXjL,GAAGkL,QAAH,CACIlL,GAAGmL,MAAH,CAAU,IAAV,EAAgBnL,GAAGmK,CAAH,CAAK,CAAL,EAAQW,KAAR,CAAhB,CADJ,EAEI9K,GAAGmL,MAAH,CAAU,IAAV,EAAgBnL,GAAGmK,CAAH,CAAK,CAAL,EAAQ,CAACW,KAAD,GAAS,CAAjB,CAAhB,CAFJ,EAGI9K,GAAGmL,MAAH,CAAU,IAAV,EAAgBnL,GAAGmK,CAAH,CAAK,CAAL,EAAQW,KAAR,CAAhB,CAHJ,CADW,EAKRC,KALQ,CAAf;AAOH,CARD;;AAUA;;;;;;AAMAlP,WAAWuP,cAAX,GAA4B,UAAU/O,KAAV,EAAiBgP,YAAjB,EAA+B;AACvD,QAAI,CAACxP,WAAWuC,OAAX,CAAmB/B,KAAnB,CAAD,IAA8B,CAACR,WAAW4H,QAAX,CAAoB4H,YAApB,CAAnC,EAAsE;AAClE,eAAO,IAAP;AACH;;AAED,QAAIC,YAAY,CAAhB;AACAA,gBAAYjP,MAAMkP,MAAN,CAAa,UAAUC,QAAV,EAAoBjP,IAApB,EAA0B;AAC/CiP,mBAAWA,WAAWjP,KAAK8O,YAAL,CAAtB;AACA,eAAOG,QAAP;AACH,KAHW,EAGTF,SAHS,CAAZ;;AAKAtL,OAAG0C,GAAH,CAAO,eAAe4I,SAAtB;AACA,QAAIG,aAAa,CAAjB;AACA,QAAIC,cAAcvO,KAAKE,MAAL,KAAgBiO,SAAlC;AACA,QAAI7O,QAAQ,IAAZ;AACA,SAAK,IAAIG,CAAT,IAAcP,KAAd,EAAqB;AACjBI,gBAAQJ,MAAMO,CAAN,CAAR;AACA6O,sBAAchP,MAAM4O,YAAN,CAAd;AACA,YAAIK,cAAcD,UAAlB,EAA8B;AAC1B,mBAAOhP,KAAP;AACH;AACJ;;AAED,WAAOA,KAAP;AACH,CAxBD;;AA0BA;;;;;;AAMAZ,WAAWkB,aAAX,GAA2B,UAAUkE,GAAV,EAAe0K,GAAf,EAAoB;AAC3C,QAAIb,QAAQ3N,KAAKyO,KAAL,CAAW,CAACD,MAAM1K,GAAP,IAAc9D,KAAKE,MAAL,EAAzB,CAAZ;AACA,WAAQ4D,MAAM6J,KAAd;AACH,CAHD;;AAKA;AACA;;;;;;;;;AASAjP,WAAWgQ,KAAX,GAAmB,UAAUrN,GAAV,EAAesN,OAAf,EAAwB;AACvC,QAAIC,SAAS,IAAInQ,SAAJ,CAAc4C,GAAd,EAAmBsN,OAAnB,CAAb;AACA,QAAIE,MAAM,EAAV;AACA,WAAOD,OAAOE,OAAP,EAAP,EAAyB;AACrB,YAAIC,KAAKH,OAAOI,OAAP,EAAT;AACAH,YAAIjO,IAAJ,CAASmO,EAAT;AACH;AACD,WAAOF,GAAP;AACH,CARD;;AAUAnQ,WAAWuQ,YAAX,GAA0B,UAAU5N,GAAV,EAAesN,OAAf,EAAwB;AAC9C,QAAIC,SAAS,IAAInQ,SAAJ,CAAc4C,GAAd,EAAmBsN,OAAnB,CAAb;AACA,QAAIE,MAAM,EAAV;AACA,WAAOD,OAAOE,OAAP,EAAP,EAAyB;AACrB,YAAIC,KAAKH,OAAOI,OAAP,EAAT;AACAH,YAAIjO,IAAJ,CAASmO,EAAT;AACH;AACD,QAAIF,IAAIrP,MAAJ,IAAc,CAAlB,EAAqB;AACjB,eAAOqP,IAAI,CAAJ,CAAP;AACH;AACD,WAAOA,GAAP;AACH,CAXD;;AAaA;;;;;;AAMAnQ,WAAWwQ,WAAX,GAAyB,UAAUC,IAAV,EAAgBC,QAAhB,EAA0BC,aAA1B,EAAyC;AAC9D,QAAI,CAACD,QAAL,EAAe;AACXA,mBAAWD,KAAKG,KAAL,EAAX;AACH;AACD,WAAOH,KAAKI,GAAL,CAAS,UAAUC,GAAV,EAAe;AAC3B,YAAI3Q,MAAM,EAAV;AACA,aAAK,IAAIY,IAAI,CAAb,EAAgBA,IAAI+P,IAAIhQ,MAAxB,EAAgCC,GAAhC,EAAqC;AACjC,gBAAI4P,aAAJ,EAAmB;AACfxQ,oBAAIuQ,SAAS3P,CAAT,CAAJ,IAAoBgQ,MAAMD,IAAI/P,CAAJ,CAAN,IAAgB+P,IAAI/P,CAAJ,CAAhB,GAAyBiQ,OAAOF,IAAI/P,CAAJ,CAAP,CAA7C;AACH,aAFD,MAEO;AACHZ,oBAAIuQ,SAAS3P,CAAT,CAAJ,IAAmB+P,IAAI/P,CAAJ,CAAnB;AACH;AACJ;AACD,eAAOZ,GAAP;AACH,KAVM,CAAP;AAWH,CAfD;;AAiBAH,WAAWiR,iBAAX,GAA+B,UAAUR,IAAV,EAAgBC,QAAhB,EAA0B;AACrD,QAAI,CAACA,QAAL,EAAe;AACXA,mBAAWD,KAAKG,KAAL,EAAX;AACH;AACD,WAAOH,KAAKI,GAAL,CAAS,UAAUC,GAAV,EAAe;AAC3B,YAAI3Q,MAAM,EAAV;AACA,aAAK,IAAIY,IAAI,CAAb,EAAgBA,IAAI+P,IAAIhQ,MAAxB,EAAgCC,GAAhC,EAAqC;AACjCZ,gBAAIuQ,SAAS3P,CAAT,CAAJ,IAAmBmQ,IAAIC,cAAJ,CAAmBL,IAAI/P,CAAJ,CAAnB,CAAnB;AACH;AACD,eAAOZ,GAAP;AACH,KANM,CAAP;AAOH,CAXD;AAYA;;;AAGAiR,OAAOC,OAAP,GAAiBrR,UAAjB","file":"UtilsOther.js","sourceRoot":"../../../../../../assets/scripts/framework/common","sourcesContent":["/**\n * Created by skyxu on 2018/3/13.\n */\n\n\"use strict\";\n\nlet Md5 = require(\"./../encrypt/Md5\");\nlet CSVParser = require(\"./CSVParser\");\n\nlet UtilsOther = UtilsOther || {};\n\n/**\n * 移除数组的指定的元素（重复元素只移除第一个）\n * @param {Array} arr\n * @param {Object} obj\n */\nUtilsOther.arrayRmObj = function (arr, obj) {\n    let index = arr.indexOf(obj);\n    arr.splice(index,1);\n};\n\n/**\n * pop a item from a array by idx\n * @param {Array} array\n * @param {Number} idx\n * @return {*}\n */\nUtilsOther.arrayPopByIdx = function (array, idx) {\n    let item = array[idx];\n    array.splice(idx, 1);\n\n    return item;\n};\n\nUtilsOther.valueInArray = function (arr, value) {\n    let len = arr.length;\n    for (let i = 0; i < len; i++) {\n        if (arr[i] == value) {\n            return true;\n        }\n    }\n    return false;\n};\n\nUtilsOther.arrayRandomValue = function (arr) {\n    let num = arr.length;\n    if (num <= 0) {\n        return null;\n    }\n\n    let idx = UtilsOther.randomInteger(0, num - 1);\n    return arr[idx];\n};\n\nUtilsOther.shuffle = function (arr) {\n    let i,\n        j,\n        temp;\n    for (i = arr.length - 1; i > 0; i--) {\n        j = Math.floor(Math.random() * (i + 1));\n        temp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = temp;\n    }\n    return arr;\n};\n\nUtilsOther.clearArrayValue = function (array, length, value) {\n    for (let i = 0; i < length; i++) {\n        array[i] = value;\n    }\n};\n\n/**\n * create a object with keys from array and initial value\n * @param {Array} array\n * @param {*} value\n * @returns {Object}\n */\nUtilsOther.createObjectWithArray = function (array, value) {\n    let object = {};\n    for (let i in array) {\n        object[array[i]] = value;\n    }\n\n    return object;\n};\n\nUtilsOther.arrayToDict = function (array, key) {\n    let dict = {};\n    let data = null;\n    for (let i in array) {\n        data = array[i];\n        dict[data[key]] = data;\n    }\n    return dict;\n};\n\nUtilsOther.dictToArray = function (dict) {\n    let array = [];\n    for (let key in dict) {\n        if (dict.hasOwnProperty(key) && dict[key]) {\n            array.push(dict[key]);\n        }\n    }\n    return array;\n};\n\n/**\n * 字典转数组\n * @param {Object} obj\n * @param {Array=} opt_arr\n * @param {Number=} opt_exclude\n * @return {Array}\n */\nUtilsOther.objectToArrayExcludeNumber = function (obj, opt_arr, opt_exclude) {\n    let tempArr;\n    if (isArray(opt_arr)) {\n        tempArr = opt_arr;\n    } else {\n        tempArr = [];\n    }\n    let key;\n    if (isNumber(opt_exclude)) {\n        let temp = opt_exclude.toString();\n        for (key in obj) {\n            if (obj.hasOwnProperty(key) && obj[key] && temp != key) {\n                tempArr.push(obj[key]);\n            }\n        }\n    } else {\n        for (key in obj) {\n            if (obj.hasOwnProperty(key) && obj[key]) {\n                tempArr.push(obj[key]);\n            }\n        }\n    }\n\n    return tempArr;\n};\n\n/**\n * 根据数据元素的类型来分割字符串，返回数据元素数组\n * @param {String} str\n * @param {*} valueType\n * @param {String} separator\n * @returns {Array}\n */\nUtilsOther.splitWithValueType = function (str, valueType, separator) {\n    if (separator === undefined) {\n        separator = \",\";\n    }\n\n    let arr = str.split(separator);\n    arr.forEach(function (currentValue, index, array) {\n        try {\n            array[index] = valueType (currentValue);\n        } catch (e) {\n            array[index] = null;\n        }\n    });\n\n    return arr;\n};\n\n/**\n * UTC 1970开始的秒数，与时区无关\n * @returns {number}\n */\nUtilsOther.time = function () {\n    return parseInt(Date.now() / 1000.0);\n};\n\n// 年月日 返回 1970开始的秒数\n/**\n *\n * @param year {int}\n * @param month {int} 1-12表示1-12月\n * @param day{int} 1-31\n * @param hour{int} 0-23\n * @param minute{int} 0-59\n * @param second{int} 0-59\n */\nUtilsOther.time2second = function (year, month, day, hour, minute, second) {\n    let date = new Date(year, month - 1, day, hour, minute, second);\n    let n = date.getTime();\n    return parseInt(n / 1000.0);\n};\n\n/**\n * 获取某个日期之后多少天的日期\n * @param time {Date || String || Number} 标准时间格式 或者 秒数(since 1970)\n * @param days {Number} 20\n * @return {Date}\n */\nUtilsOther.getTimeAfterDays = function (time, days) {\n    cc.assert(time, \"getTimeForDayAfterDays:time is null!\");\n    var date = null;\n    if (cc.isNumber(time)) {\n        date = new Date(time * 1000);\n    } else {\n        date = new Date(time);\n    }\n    return new Date(date.getTime() + days * 24 * 60 * 60 * 1000);\n};\n\n/**\n * 判断两个日期相差多少天\n * @param strDateStart  开始时间 标准时间格式 或者 秒数（since 1970)\n * @param strDateEnd    结束时间 标准时间格式 或者 秒数（since 1970)\n * @return {Number|*}   天数\n */\nUtilsOther.getDaysDiff = function (dateStart, dateEnd) {\n    cc.assert(dateStart && dateEnd, \"getDaysDiff: date must be not null!\");\n    var iDays;\n    if (UtilsOther.isNumber(dateStart)) {\n        dateStart = new Date(dateStart * 1000);\n    } else {\n        dateStart = new Date(dateStart);\n    }\n    if (UtilsOther.isNumber(dateEnd)) {\n        dateEnd = new Date(dateEnd * 1000);\n    } else {\n        dateEnd = new Date(dateEnd);\n    }\n\n    var strDateS = new Date(dateStart.getFullYear(), dateStart.getMonth(), dateStart.getDate());\n    var strDateE = new Date(dateEnd.getFullYear(), dateEnd.getMonth(), dateEnd.getDate());\n    iDays = parseInt(Math.abs(strDateE - strDateS) / 1000 / 60 / 60 / 24);   //把相差的毫秒数转换为天数\n    iDays *= (strDateE >= strDateS ? 1 : -1);\n    // cc.log(\"day dif:\" + iDays);\n    return iDays;\n};\n\n/**\n *\n * @param date{Date || String || Number} 标准时间格式 或者 秒数(since 1970)\n * @return {string} 格式 \"2017-08-02\"\n */\nUtilsOther.getTimeForDay = function (date) {\n    if (!date) {\n        date = new Date();\n    } else if (cc.isNumber(date)) {\n        date = new Date(date * 1000);\n    } else {\n        date = new Date(date);\n    }\n    var year = date.getFullYear();\n    var month = date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1)\n        : date.getMonth() + 1;\n    var day = date.getDate() < 10 ? \"0\" + date.getDate() : date\n        .getDate();\n    var dateStr = year + \"-\" + month + \"-\" + day;\n    return dateStr;\n};\n\n\n/**\n *\n * @param s {Number} 秒\n * @return {string}\n */\nUtilsOther.formatTime = function (s) {\n    let t;\n    if (s >= 0) {\n        let hour = Math.floor(s / 3600);\n        let min = Math.floor(s / 60) % 60;\n        let sec = s % 60;\n        let day = parseInt(hour / 24);\n        if (day == 1) {\n            return day + \" day\";\n        }\n        if (day > 1) {\n            return day + \" days\";\n        }\n\n        if (day > 0) {\n            hour = hour - 24 * day;\n            t = day + \"day \" + ('00' + hour).slice(-2) + \":\";\n        }\n        else if (hour > 0) {\n            t = ('00' + hour).slice(-2) + \":\";\n        } else {\n            t = \"\";\n        }\n        \n        if (min < 10) {\n            t += \"0\";\n        }\n        t += min + \":\";\n        if (sec < 10) {\n            t += \"0\";\n        }\n        t += parseInt(sec);\n    }\n    return t;\n};\n\n/**\n * 返回100，000类型字符串\n * @param {Number} number\n * @returns {String}\n */\nUtilsOther.getThousandSeparatorString = function (number) {\n\n    // return number.toString().split('').reverse().join('').replace(/(\\d{3}(?=\\d)(?!\\d+\\.|$))/g, '$1,').split('').reverse().join('');\n    // 保留一位小数\n    let str = number.toString().split('').reverse().join('').replace(/(\\d{3}(?=\\d)(?!\\d+\\.|$))/g, '$1,').split('').reverse().join('');\n    let dot = str.indexOf('.');\n    if (dot >= 0) {\n        str = str.substring(0, dot + 2);\n    }\n    return str;\n};\n\nUtilsOther.getKMBString = function (number) {\n    if (!this.isNumber(number)) {\n        return number;\n    }\n\n    if (number / 1000000000 >= 1) {\n        return this.getThousandSeparatorString(number / 1000000000) + \"B\";\n    }\n    else if (number / 1000000 >= 1) {\n        return this.getThousandSeparatorString(number / 1000000) + \"M\";\n    }\n    // 至少显示10k\n    else if (number / 10000 >= 1) {\n        return this.getThousandSeparatorString(number / 1000) + \"K\";\n    }\n    return this.getThousandSeparatorString(number);\n};\n\n/**\n * 返回截止日期\n * @param {Number} current\n * @param {Number} cutOff\n * @return {Number}\n */\nUtilsOther.getLastCutOffDay = function (current, cutOff) {\n    let time = cutOff - current;\n    if (time < 0) return -1;\n    time = parseInt(time / (24 * 3600));\n    return time;\n};\n\nUtilsOther._dumpObject = function (prefix, o, depth, extraBlank, _ignore_function_member, max_depth) {\n    if (UtilsOther.D(max_depth) && depth > max_depth) {\n        return;\n    }\n\n    function printWithDepth(txt, depth, extraBlank) {\n        while (depth > 0) {\n            txt = \"  \" + txt;\n            --depth;\n        }\n        if (extraBlank > 0) {\n            let blanks = \"\";\n            let i;\n            for (i = 0; i < extraBlank; ++i) {\n                blanks += \" \";\n            }\n            txt = blanks + txt;\n        }\n        cc.log(txt);\n    }\n\n    function getFuncDescriptor(f) {\n        return (f.toString().replace(/function\\s?/mi, \"\").split(\")\"))[0] + \")\";\n    }\n\n    let type = Object.prototype.toString.call(o).slice(8, -1);\n    let t;\n    let neb;\n    let npfx;\n    let len;\n    let blanks;\n    switch (type) {\n        case \"Number\":\n        case \"String\":\n            t = \"\\\"\" + o.toString() + \"\\\"\";\n            if (prefix) {\n                t = prefix + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n            break;\n        case \"Undefined\":\n            t = 'UNDEFINED!';\n            if (prefix) {\n                t = prefix + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n            break;\n        case \"Boolean\":\n\n            t = o.toString();\n            if (prefix) {\n                t = prefix + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n\n            break;\n        case \"Object\":\n\n            t = \"{\";\n            if (prefix) {\n                t = prefix + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n            let prop;\n            for (prop in o) {\n                if (!o.hasOwnProperty(prop)) {\n                    continue;\n                }\n                npfx = \"\\\"\" + prop + \"\\\" : \";\n                neb = (prefix ? prefix.length : 0) - 2 + extraBlank;\n                _dumpObject(npfx, o[prop], depth + 1, neb, _ignore_function_member, max_depth);\n            }\n\n            len = prefix ? prefix.length : 0;\n            t = \"}\";\n            if (len > 0) {\n                blanks = \"\";\n                let i1;\n                for (i1 = 0; i1 < len; ++i1) {\n                    blanks += \" \";\n                }\n                t = blanks + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n\n            break;\n        case \"Array\":\n\n            t = \"[\";\n            if (prefix) {\n                t = prefix + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n            let i2;\n            for (i2 = 0; i2 < o.length; ++i2) {\n                npfx = i2 + \" : \";\n                neb = (prefix ? prefix.length : 0) - 2 + extraBlank;\n                _dumpObject(npfx, o[i2], depth + 1, neb, _ignore_function_member, max_depth);\n            }\n\n            len = prefix ? prefix.length : 0;\n            t = \"]\";\n            if (len > 0) {\n                blanks = \"\";\n                let i;\n                for (i = 0; i < len; ++i) {\n                    blanks += \" \";\n                }\n                t = blanks + t;\n            }\n            printWithDepth(t, depth, extraBlank);\n\n            break;\n        case \"Function\":\n\n            if (!_ignore_function_member) {\n                t = getFuncDescriptor(o);\n                if (prefix) {\n                    t = prefix + t;\n                }\n                printWithDepth(t, depth, extraBlank);\n            }\n            break;\n    }\n};\n\n/**\n * 打印对象的所有属性和方法\n * @param o 目标对象\n * @param _ignore_function_member 是否忽略函数\n * @param max_depth 显示的深度\n */\nUtilsOther.dumpObject = function (o, _ignore_function_member, max_depth) {\n    UtilsOther._dumpObject(undefined, o, 0, 0, _ignore_function_member || false, max_depth);\n};\n\n/**\n * 对象已定义\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.D = function (obj) {\n    return obj !== undefined;\n};\n\n/**\n * 对象已定义，且不为空\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.DNN = function (obj) {\n    return obj !== undefined && obj !== null;\n};\n\n/**\n * Check the obj whether is function or not\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.isFunction = function (obj) {\n    return typeof obj === 'function';\n};\n\n/**\n * Check the obj whether is number or not\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.isNumber = function (obj) {\n    return typeof obj === 'number' || Object.prototype.toString.call(obj) === '[object Number]';\n};\n\n/**\n * Check the obj whether is string or not\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.isString = function (obj) {\n    return typeof obj === 'string' || Object.prototype.toString.call(obj) === '[object String]';\n};\n\nUtilsOther.isArray = function (obj) {\n    return Array.isArray(obj) ||\n        (typeof obj === 'object' && Object.prototype.toString.call(obj) === '[object Array]');\n\n};\n\n/**\n * Check the obj whether is undefined or not\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.isUndefined = function (obj) {\n    return obj === undefined;\n};\n\n/**\n * Check the obj whether is object or not\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.isObject = function (obj) {\n    return typeof obj === \"object\" && Object.prototype.toString.call(obj) === '[object Object]';\n};\n\n/**\n * Check the obj whether is {}, [] or not\n * @param {*} obj\n * @returns {boolean}\n */\nUtilsOther.isEmpty = function (obj) {\n    return (Array.isArray(obj) && obj.length === 0)\n        || (Object.prototype.isPrototypeOf(obj) && Object.keys(obj).length === 0);\n};\n\n/**\n * Check the obj whether is boolean or not\n * @param {Array | Object}obj\n * @returns {boolean}\n */\nUtilsOther.isBoolean = function (obj) {\n    return obj === true || obj === false || Object.prototype.toString.call(obj) === '[object Boolean]';\n};\n\n/**\n * Create a new object and copy all properties in an exist object to the new object\n * @function\n * @param {object|Array} obj The source object\n * @param {object|Array} newObj The target object\n * @return {Array|object} The created object\n */\nUtilsOther.clone = function (obj, newObj) {\n    // Cloning is better if the new object is having the same prototype chain\n    // as the copied obj (or otherwise, the cloned object is certainly going to\n    // have a different hidden class). Play with C1/C2 of the\n    // PerformanceVirtualMachineTests suite to see how this makes an impact\n    // under extreme conditions.\n    //\n    // Object.create(Object.getPrototypeOf(obj)) doesn't work well because the\n    // prototype lacks a link to the constructor (Carakan, V8) so the new\n    // object wouldn't have the hidden class that's associated with the\n    // constructor (also, for whatever reasons, utilizing\n    // Object.create(Object.getPrototypeOf(obj)) + Object.defineProperty is even\n    // slower than the original in V8). Therefore, we call the constructor, but\n    // there is a big caveat - it is possible that the this.init() in the\n    // constructor would throw with no argument. It is also possible that a\n    // derived class forgets to set \"constructor\" on the prototype. We ignore\n    // these possibities for and the ultimate solution is a standardized\n    // Object.clone(<object>).\n    if (!newObj) {\n        newObj = (obj.constructor) ? new obj.constructor() : {};\n    }\n\n    // Assuming that the constuctor above initialized all properies on obj, the\n    // following keyed assignments won't turn newObj into dictionary mode\n    // becasue they're not *appending new properties* but *assigning existing\n    // ones* (note that appending indexed properties is another story). See\n    // CCClass.js for a link to the devils when the assumption fails.\n    let key;\n    let copy;\n    for (key in obj) {\n        if (!obj.hasOwnProperty(key)) {\n            continue;\n        }\n        copy = obj[key];\n        // Beware that typeof null == \"object\" !\n        if (((typeof copy) === \"object\") && copy) {\n            newObj[key] = UtilsOther.clone(copy, null);\n        } else {\n            newObj[key] = copy;\n        }\n    }\n    return newObj;\n};\n\n//---------------------------------------------------------------------------\n\n/**\n * Load a single resource as txt synchronize with check platform.\n * @param {String} fileName\n * @returns {String}\n */\nUtilsOther.getStringFromFile = function (fileName) {\n    if (cc.sys.isNative) {\n        return jsb.fileUtils.getStringFromFile(fileName);\n    } else {\n        let _loadTxtSync = function (url) {\n            if (!cc._isNodeJs) {\n                let xhr = this.getXMLHttpRequest();\n                xhr.timeout = 0;\n                xhr.open(\"GET\", url, false);\n                if (/msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent)) {\n                    // IE-specific logic here\n                    xhr.setRequestHeader(\"Accept-Charset\", \"utf-8\");\n                } else {\n                    if (xhr.overrideMimeType) xhr.overrideMimeType(\"text\\/plain; charset=utf-8\");\n                }\n                xhr.send(null);\n                if (!xhr.readyState === 4 || xhr.status !== 200) {\n                    return null;\n                }\n                return xhr.responseText;\n            } else {\n                let fs = require(\"fs\");\n                return fs.readFileSync(url).toString();\n            }\n        }.bind(cc.loader);\n\n        return _loadTxtSync(fileName);\n    }\n};\n\n/**\n * 求线段ab和cd的交点，如果不相交则返回false，相交则返回交点坐标\n * @param a{cc.Vec2}\n * @param b{cc.Vec2}\n * @param c{cc.Vec2}\n * @param d{cc.Vec2}\n * @returns {*}\n */\nUtilsOther.getSegmentsInter = function (a, b, c, d) {\n    //线段ab的法线N1\n    var nx1 = (b.y - a.y), ny1 = (a.x - b.x);\n\n    //线段cd的法线N2\n    var nx2 = (d.y - c.y), ny2 = (c.x - d.x);\n\n    //两条法线做叉乘, 如果结果为0, 说明线段ab和线段cd平行或共线,不相交\n    var denominator = nx1*ny2 - ny1*nx2;\n    if (denominator==0) {\n        return false;\n    }\n\n    //在法线N2上的投影\n    var distC_N2=nx2 * c.x + ny2 * c.y;\n    var distA_N2=nx2 * a.x + ny2 * a.y-distC_N2;\n    var distB_N2=nx2 * b.x + ny2 * b.y-distC_N2;\n\n    // 点a投影和点b投影在点c投影同侧 (对点在线段上的情况,本例当作不相交处理);\n    if ( distA_N2*distB_N2>=0  ) {\n        return false;\n    }\n\n    //\n    //判断点c点d 和线段ab的关系, 原理同上\n    //\n    //在法线N1上的投影\n    var distA_N1=nx1 * a.x + ny1 * a.y;\n    var distC_N1=nx1 * c.x + ny1 * c.y-distA_N1;\n    var distD_N1=nx1 * d.x + ny1 * d.y-distA_N1;\n    if ( distC_N1*distD_N1>=0  ) {\n        return false;\n    }\n\n    //计算交点坐标\n    var fraction= distA_N2 / denominator;\n    var dx= fraction * ny1,\n        dy= -fraction * nx1;\n    return { x: a.x + dx , y: a.y + dy };\n};\n\nUtilsOther.getDistance = function(vec1, vec2) {\n    let d = Math.sqrt(Math.pow(vec2.x-vec1.x, 2) + Math.pow(vec2.y-vec1.y, 2));\n    return d;\n};\n\n/**\n * 读取远程图片资源（在native平台会缓存下来）\n * @param url\n * @param callback\n */\nUtilsOther.loadRemoteImg = function (url, callback) {\n    if (cc.sys.isBrowser){\n        cc.log(\"Remote img load web\");\n        cc.loader.load(url,function(progress){\n            cc.log(\"Remote img load progress:\"+progress);\n        },function(error,tex){\n            if(error)\n            {\n                cc.log(\"Remote img load error:\"+error);\n                return;\n            }\n            cc.log(\"Remote img load success.\");\n            callback(tex);\n        });\n\n        return;\n    }\n\n    cc.log(\"Remote img load: native\");\n    let dirpath = jsb.fileUtils.getWritablePath() + 'img/';\n    let filepath = dirpath + Md5.md5_hex(url) + '.png';\n\n    function loadEnd() {\n        cc.loader.load(filepath, function (err, tex) {\n            if (err) {\n                cc.error(err);\n            } else {\n                callback(tex);\n            }\n        });\n\n    }\n\n    if (jsb.fileUtils.isFileExist(filepath)) {\n        cc.log('Remote is find' + filepath);\n        loadEnd();\n        return;\n    }\n\n    let saveFile = function (data) {\n        cc.log(typeof data);\n        cc.log(data);\n        let b = new Uint8Array(data);\n        cc.log(typeof b);\n        cc.log(b.length);\n        if (typeof data !== 'undefined') {\n            if (!jsb.fileUtils.isDirectoryExist(dirpath)) {\n                jsb.fileUtils.createDirectory(dirpath);\n            }\n            cc.log(\"111111\" + filepath);\n            if (jsb.fileUtils.writeDataToFile(new Uint8Array(data), filepath)) {\n                cc.log('Remote img save succeed.');\n                cc.log(\"22222\");\n\n                loadEnd();\n            } else {\n                cc.log('Remote img save failed.');\n            }\n        } else {\n            cc.log('Remote img download failed.');\n        }\n    };\n\n    let xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function () {\n        cc.log(\"xhr.readyState  \" + xhr.readyState);\n        cc.log(\"xhr.status  \" + xhr.status);\n        if (xhr.readyState === 4) {\n            if (xhr.status === 200) {\n                xhr.responseType = 'arraybuffer';\n                saveFile(xhr.response);\n            } else {\n                saveFile(null);\n            }\n        }\n    }.bind(this);\n    xhr.open(\"GET\", url, true);\n    xhr.send();\n};\n\n/**\n * 检测触摸是否击中\n * @param {cc.Point} touchPoint\n * @param {cc.Node} node\n * @return {Boolean}\n */\nUtilsOther.checkTouchIsHit = function (touchPoint, node) {\n    return cc.rectContainsPoint(node.getBoundingBoxToWorld(), touchPoint);\n};\n\n/**\n * 创建剪裁容器\n * @param {String} spriteName\n * @return {cc.ClippingNode}\n */\nUtilsOther.createCliper = function (spriteName) {\n    //创建一个遮罩的模板\n    let stencil = new cc.Sprite(spriteName);\n    //创建一个ClippingNode 并设置一些基础属性 容器宽高与模板有关\n    let clippingNode = new cc.ClippingNode();\n    clippingNode.attr({\n        stencil: stencil,\n        anchorX: 0.5,\n        anchorY: 0.5,\n        alphaThreshold: 0.8 //设置裁剪透明值阀值 默认值为1 等于1时alpha = 0的部分也被裁剪\n    });\n\n    return clippingNode;\n};\n\n// TODO: 暂时未使用\n/**\n * 得到节点在世界坐标系中的边界\n * @param node\n * @return {{x, y, width, height}}\n */\nUtilsOther.convertBoundingBoxToWorld = function (node) {\n    if (!node) {\n        return cc.rect();\n    }\n\n    let leftBottom = node.convertToWorldSpace(cc.p());\n    let rightTop = node.convertToWorldSpace(cc.pFromSize(node.getContentSize()));\n\n    return cc.rect(leftBottom.x, leftBottom.y, rightTop.x - leftBottom.x, rightTop.y - leftBottom.y);\n};\n\n/**\n * 根据节点和指定的锚点得到坐标\n * @param {cc.Node} node\n * @param {cc.Point} anchorPoint\n * @return {*}\n */\nUtilsOther.getPositionByAnchor = function (node, anchorPoint) {\n    if (!node) {\n        return cc.p();\n    }\n\n    let bounding = node.getBoundingBox();\n    bounding.x += bounding.width * anchorPoint.x;\n    bounding.y += bounding.height * anchorPoint.y;\n    return cc.p(bounding.x, bounding.y);\n};\n\n/**\n * 运行震动效果\n * @param node\n * @param range\n * @param times\n */\nUtilsOther.runShakeAction = function (node, range, times) {\n    node.runAction(cc.repeat(\n        cc.sequence(\n            cc.moveBy(0.02, cc.p(0, range)),\n            cc.moveBy(0.04, cc.p(0, -range * 2)),\n            cc.moveBy(0.02, cc.p(0, range))\n        ), times\n    ))\n};\n\n/**\n * 根据配置的权重随机出一个对象\n * @param array {Array} Object对象的数组\n * @param keyForWeight {String} Object对象中定义权重的属性key(权重为Number类型)\n * @return {Object}\n */\nUtilsOther.randomByWeight = function (array, keyForWeight) {\n    if (!UtilsOther.isArray(array) || !UtilsOther.isString(keyForWeight)) {\n        return null;\n    }\n\n    let sumWeight = 0;\n    sumWeight = array.reduce(function (sumSoFar, item) {\n        sumSoFar = sumSoFar + item[keyForWeight];\n        return sumSoFar;\n    }, sumWeight);\n\n    cc.log(\"sumWeight:\" + sumWeight);\n    let tempWeight = 0;\n    let randomValue = Math.random() * sumWeight;\n    let value = null;\n    for (let i in array) {\n        value = array[i];\n        tempWeight += value[keyForWeight];\n        if (randomValue < tempWeight) {\n            return value;\n        }\n    }\n\n    return value;\n};\n\n/**\n * 根据最小值和最大值得到一个随机整数\n * @param {Number} min\n * @param {Number} max\n * @returns {Number}\n */\nUtilsOther.randomInteger = function (min, max) {\n    let range = Math.round((max - min) * Math.random());\n    return (min + range);\n};\n\n//******************csv begin*****************\n/**\n * @return String[][]\n * DefaultOptions: {\n        delim: ',',\n        quote: '\"',\n        rowdelim: '\\n'\n        // rowdelim: '\\r\\n'\n    }\n */\nUtilsOther.parse = function (str, options) {\n    let parser = new CSVParser(str, options);\n    let all = [];\n    while (parser.hasNext()) {\n        let ar = parser.nextRow();\n        all.push(ar);\n    }\n    return all;\n};\n\nUtilsOther.parseOneLine = function (str, options) {\n    let parser = new CSVParser(str, options);\n    let all = [];\n    while (parser.hasNext()) {\n        let ar = parser.nextRow();\n        all.push(ar);\n    }\n    if (all.length <= 1) {\n        return all[0];\n    }\n    return all;\n};\n\n/**\n * @param rows String[][]\n * @param colnames String[]\n * @param {Boolean} isParseNumber 是否需要解析成相应的数字\n * @return Object[]\n */\nUtilsOther.bindColumns = function (rows, colnames, isParseNumber) {\n    if (!colnames) {\n        colnames = rows.shift();\n    }\n    return rows.map(function (row) {\n        let obj = {};\n        for (let i = 0; i < row.length; i++) {\n            if (isParseNumber) {\n                obj[colnames[i]] = (isNaN(row[i]) ? row[i] : Number(row[i]));\n            } else {\n                obj[colnames[i]] = row[i];\n            }\n        }\n        return obj;\n    });\n};\n\nUtilsOther.bindColumnsSimple = function (rows, colnames) {\n    if (!colnames) {\n        colnames = rows.shift();\n    }\n    return rows.map(function (row) {\n        let obj = {};\n        for (let i = 0; i < row.length; i++) {\n            obj[colnames[i]] = CSV.parseOneSimple(row[i]);\n        }\n        return obj;\n    });\n};\n//*******************csv end*******************\n\n\nmodule.exports = UtilsOther;"]}